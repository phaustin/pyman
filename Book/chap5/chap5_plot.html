

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>5. Plotting &mdash; Scientific python tutorial 1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="6. Conditionals and Loops" href="../chap6/chap6_loopsconds.html" />
    <link rel="prev" title="4. Input and Output" href="../chap4/chap4_io.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Scientific python tutorial
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../chap1/chap1_intro.html">1. Chapter 1: Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chap2/chap2_basics.html">2. Chapter 2: First Steps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chap3/chap3_arrays.html">3. Chapter 3: Arrays</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chap4/chap4_io.html">4. Chapter 4: Input and Output</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">5. Chapter 5: Plotting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#An-interactive-session-with-pyplot">5.1. An interactive session with <code class="docutils literal notranslate"><span class="pre">pyplot</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#Basic-plotting">5.2. Basic plotting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Specifying-line-and-symbol-types-and-colors">5.2.1. Specifying line and symbol types and colors</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Error-bars">5.2.2. Error bars</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Setting-plotting-limits-and-excluding-data">5.2.3. Setting plotting limits and excluding data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Setting-plotting-limits">5.2.3.1. Setting plotting limits</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Masked-arrays">5.2.3.2. Masked arrays</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Subplots">5.2.4. Subplots</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Logarithmic-plots">5.3. Logarithmic plots</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Semi-log-plots">5.3.1. Semi-log plots</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#The-tight_layout()-function">5.3.1.1. The <code class="docutils literal notranslate"><span class="pre">tight_layout()</span></code> function</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Log-log-plots">5.3.2. Log-log plots</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#More-advanced-graphical-output">5.4. More advanced graphical output</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Exercises">5.5. Exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../chap6/chap6_loopsconds.html">6. Chapter 6: Flow control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chap7/chap7_funcs.html">7. Chapter 7: Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chap8/chap8_fitting.html">8. Chapter 8: Curve Fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chap9/chap9_scipy.html">9. Chapter 9: Scipy</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Scientific python tutorial</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li><span class="section-number">5. </span>Plotting</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/Book/chap5/chap5_plot.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    min-width: 5ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<h1><p>Table of Contents</p>
</h1><div class="toc"><ul class="toc-item"><li><p>1  Plotting</p>
<ul class="toc-item"><li><p>1.1  An interactive session with pyplot</p>
</li><li><p>1.2  Basic plotting</p>
<ul class="toc-item"><li><p>1.2.1  Specifying line and symbol types and colors</p>
</li><li><p>1.2.2  Error bars</p>
</li><li><p>1.2.3  Setting plotting limits and excluding data</p>
</li><li><p>1.2.4  Subplots</p>
</li></ul></li><li><p>1.3  Logarithmic plots</p>
<ul class="toc-item"><li><p>1.3.1  Semi-log plots</p>
</li><li><p>1.3.2  Log-log plots</p>
</li></ul></li><li><p>1.4  More advanced graphical output</p>
</li><li><p>1.5  Exercises</p>
</li></ul></li></ul></div><p>python</p>
<div class="section" id="Plotting">
<h1><span class="section-number">5. </span>Plotting<a class="headerlink" href="#Plotting" title="Permalink to this headline">¶</a></h1>
<p>single: MatPlotLib single: plots</p>
<p>The graphical representation of data—plotting—is one of the most important tools for evaluating and understanding scientific data and theoretical predictions. However, plotting is not a part of core Python but is provided through one of several possible library modules. The most highly developed and widely used plotting package for Python is MatPlotLib (<a class="reference external" href="http://MatPlotLib.sourceforge.net/">http://MatPlotLib.sourceforge.net/</a>). It is a powerful and flexible program that has become the <em>de facto</em> standard for 2-d plotting with Python.</p>
<p>Because MatPlotLib is an external library—in fact it’s a collection of libraries—it must be imported into any routine that uses it. MatPlotLib makes extensive use of NumPy so the two should be imported together. Therefore, for any program for which you would like to produce 2-d plots, you should include the lines</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
<p>There are other MatPlotLib sub-libraries, but the <code class="docutils literal notranslate"><span class="pre">pyplot</span></code> library provides nearly everything that you need for 2-d plotting. The standard prefix for it is <code class="docutils literal notranslate"><span class="pre">plt</span></code>. The two statements above must appear before any calls to NumPy or MatPlotLib routines are made.</p>
<p>One final word before we get started: We only scratch the surface of what is possible using MatPlotLib and as you become familiar with it, you will surely want to do more than this manual describes. In that case, you need to go the the web to get more information. A good place to start is <a class="reference external" href="http://matplotlib.org/api/pyplot_summary.html">http://matplotlib.org/api/pyplot_summary.html</a>. Another interesting web page is <a class="reference external" href="http://matplotlib.org/gallery.html">http://matplotlib.org/gallery.html</a>.</p>
<div class="section" id="An-interactive-session-with-pyplot">
<h2><span class="section-number">5.1. </span>An interactive session with <code class="docutils literal notranslate"><span class="pre">pyplot</span></code><a class="headerlink" href="#An-interactive-session-with-pyplot" title="Permalink to this headline">¶</a></h2>
<p>single: plots; interactive</p>
<p>We begin with an interactive plotting session that illustrates some very basic features of MatPlotLib. Type in the <code class="docutils literal notranslate"><span class="pre">plot</span></code> command shown below and press the return key. Take care to follow the exact syntax.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">MatPlotLib</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">Line2D</span> <span class="n">at</span> <span class="mh">0x94e1310</span><span class="o">&gt;</span><span class="p">]</span>
</pre></div>
</div>
<figure><figcaption><p>Interactive plot window</p>
</figcaption></figure><p>A window should appear with a plot that looks something like the <code class="docutils literal notranslate"><span class="pre">fig-zigzagPlotDemo</span></code> shown here. By default, the <code class="docutils literal notranslate"><span class="pre">plot</span></code> function draws a line between the data points that were entered. You can save this plot to an image file by clicking on the floppy disk icon at the top of the plot window. You can also zoom, pan, scroll through the plot, and return to the original view using the other icons in the plot window. Experimenting with them reveals their functions.</p>
<p>When you are finished, be sure to close the plot window.</p>
<p>Let’s take a closer look at the <code class="docutils literal notranslate"><span class="pre">plot</span></code> function. It is used to plot <span class="math notranslate nohighlight">\(x\)</span>-<span class="math notranslate nohighlight">\(y\)</span> data sets and is written like this</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are arrays (or lists) that have the same size. If the <code class="docutils literal notranslate"><span class="pre">x</span></code> array is missing, that is, if there is only a single array, as in our example above, the <code class="docutils literal notranslate"><span class="pre">plot</span></code> function uses <code class="docutils literal notranslate"><span class="pre">0,</span> <span class="pre">1,</span> <span class="pre">...,</span> <span class="pre">N-1</span></code> for the <code class="docutils literal notranslate"><span class="pre">x</span></code> array, where <code class="docutils literal notranslate"><span class="pre">N</span></code> is the size of the <code class="docutils literal notranslate"><span class="pre">y</span></code> array. Thus, the <code class="docutils literal notranslate"><span class="pre">plot</span></code> function provides a quick graphical way of examining a data set.</p>
<p>More typically, you supply both an <span class="math notranslate nohighlight">\(x\)</span> and a <span class="math notranslate nohighlight">\(y\)</span> data set to plot. Taking things a bit further, you may also want to plot several data sets on the same graph, use symbols as well as lines, label the axes, create a title and a legend, and control the color of symbols and lines. All of this is possible but requires calling a number of plotting functions. For this reason, plotting is usually done using a Python script or program.</p>
</div>
<div class="section" id="Basic-plotting">
<h2><span class="section-number">5.2. </span>Basic plotting<a class="headerlink" href="#Basic-plotting" title="Permalink to this headline">¶</a></h2>
<p>single: plots; basic</p>
<p>The quickest way to learn how to plot using the MatPlotLib library is by example. For our first task, let’s plot the sine function over the interval from 0 to <span class="math notranslate nohighlight">\(4\pi\)</span>. The main plotting function <code class="docutils literal notranslate"><span class="pre">plot</span></code> in MatPlotLib does not plot functions <em>per se</em>, it plots <span class="math notranslate nohighlight">\((x,y)\)</span> data points. As we shall see, we can instruct the function <code class="docutils literal notranslate"><span class="pre">plot</span></code> either to just draw point—or dots—at each data point, or we can instruct it to draw straight lines between the data points. To create the illusion of
the smooth function that the sine function is, we need to create enough <span class="math notranslate nohighlight">\((x,y)\)</span> data points so that when <code class="docutils literal notranslate"><span class="pre">plot</span></code> draws straight lines between the data points, the function appears to be smooth. The sine function undergoes two full oscillations with two maxima and two minima between 0 and <span class="math notranslate nohighlight">\(4\pi\)</span>. So let’s start by creating an array with 33 data points between 0 and <span class="math notranslate nohighlight">\(4\pi\)</span>, and then let MatPlotLib draw a straight line between them. Our code consists of four parts</p>
<ul class="simple">
<li><p>import the NumPy and MatPlotLib modules (lines 1-2 below)</p></li>
<li><p>create the <span class="math notranslate nohighlight">\((x,y)\)</span> data arrays (lines 3-4 below)</p></li>
<li><p>have <code class="docutils literal notranslate"><span class="pre">plot</span></code> draw straight lines between the <span class="math notranslate nohighlight">\((x,y)\)</span> data points (line 5 below)</p></li>
<li><p>display the plot in a figure window using the <code class="docutils literal notranslate"><span class="pre">show</span></code> function (line 6 below)</p></li>
</ul>
<p>Here is our code, which consists of only 6 lines:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">4.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">33</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure><figcaption><p>Sine function</p>
</figcaption></figure><p>Only 6 lines suffice to create the plot, which consists of the sine function over the interval from 0 to <span class="math notranslate nohighlight">\(4\pi\)</span>, as advertised, as well as axes annotated with nice whole numbers over the appropriate interval. It’s a pretty nice plot made with very little code.</p>
<p>One problem, however, is that while the plot oscillates like a sine wave, it is not smooth. This is because we did not create the <span class="math notranslate nohighlight">\((x,y)\)</span> arrays with enough data points. To correct this, we need more data points. The plot below was created using the same program shown above but with 129 <span class="math notranslate nohighlight">\((x,y)\)</span> data points instead of 33. Try it out your self by copying the above program and replacing 33 in line 3 with 129 so that the function <code class="docutils literal notranslate"><span class="pre">linspace</span></code> creates an array with 129 data points instead
of 33.</p>
<figure><figcaption><p>Sine function plotted using more data points</p>
</figcaption></figure><p>The code above illustrates how plots can be made with very little code using the MatPlotLib module. In making this plot, MatPlotLib has made a number of choices, such as the size of the figure, the blue color of the line, even the fact that by default a line is drawn between successive data points in the <span class="math notranslate nohighlight">\((x,y)\)</span> arrays. All of these choices can be changed by explicitly instructing MatPlotLib to do so. This involves including more arguments in the function calls we have used and using new
functions that control other properties of the plot. The next example illustrates a few of the simpler embellishments that are possible.</p>
<p>In the <code class="docutils literal notranslate"><span class="pre">fig-WavyPulse</span></code> figure, we plot two <span class="math notranslate nohighlight">\((x,y)\)</span> data sets: a smooth line curve and some data represented by red circles. In this plot, we label the <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> axes, create a legend, and draw lines to indicate where <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> are zero. The code that creates this plot is shown below.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># read data from file</span>
<span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;wavePulseData.txt&#39;</span><span class="p">,</span> <span class="n">unpack</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># create x and y arrays for theory</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">10.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="mf">5.0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># create plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;theory&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;transverse displacement&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># save plot to file</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;WavyPulse.pdf&#39;</span><span class="p">)</span>

<span class="c1"># display plot on screen</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure><figcaption><p>Wavy pulse</p>
</figcaption></figure><p>If you have read the first four chapters, the code in lines 1-9 in the above script should be familiar to you. Fist, the script loads the NumPy and MatPlotLib modules, then reads data from a data file into two arrays, <code class="docutils literal notranslate"><span class="pre">xdata</span></code> and <code class="docutils literal notranslate"><span class="pre">ydata</span></code>, and then creates two more arrays, <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code>. The first pair or arrays, <code class="docutils literal notranslate"><span class="pre">xdata</span></code> and <code class="docutils literal notranslate"><span class="pre">ydata</span></code>, contain the <span class="math notranslate nohighlight">\(x\)</span>-<span class="math notranslate nohighlight">\(y\)</span> data that are plotted as red circles in the <code class="docutils literal notranslate"><span class="pre">fig-WavyPulse</span></code> figure; the arrays created in line 8 and 9 contain the
<span class="math notranslate nohighlight">\(x\)</span>-<span class="math notranslate nohighlight">\(y\)</span> data that are plotted as a blue line.</p>
<p>The functions that do the plotting begin on line 12. Let’s go through them one by one and see what they do. You will notice in several cases that <em>keyword arguments</em> (<code class="docutils literal notranslate"><span class="pre">kwargs</span></code>) are used in several cases. Keyword arguments are <em>optional</em> arguments that have the form <code class="docutils literal notranslate"><span class="pre">kwarg=</span></code> <em>data</em>, where <em>data</em> might be a number, a string, a tuple, or some other form of data.</p>
<blockquote>
<div><div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">figure()</span></code></div>
<div class="line">creates a blank figure window. If it has no arguments, it creates a window that is 8 inches wide and 6 inches high by default, although the size that appears on your computer depends on your screen’s resolution. For most computers, it will be much smaller. You can create a window whose size differs from the default using the optional keyword argument <code class="docutils literal notranslate"><span class="pre">figsize</span></code>, as we have done here. If you use <code class="docutils literal notranslate"><span class="pre">figsize</span></code>, set it equal to a 2-element tuple where the elements are the width and height,
respectively, of the plot. Multiple calls to <code class="docutils literal notranslate"><span class="pre">figure()</span></code> opens multiple windows: <code class="docutils literal notranslate"><span class="pre">figure(1)</span></code> opens up one window for plotting, <code class="docutils literal notranslate"><span class="pre">figure(2)</span></code> another, and <code class="docutils literal notranslate"><span class="pre">figure(3)</span></code> yet another.</div>
</div>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">plot(x,</span> <span class="pre">y,</span></code> <em>optional arguments</em> <code class="docutils literal notranslate"><span class="pre">)</span></code></div>
<div class="line">graphs the <span class="math notranslate nohighlight">\(x\)</span>-<span class="math notranslate nohighlight">\(y\)</span> data in the arrays <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code>. The third argument is a format string that specifies the color and the type of line or symbol that is used to plot the data. The string <code class="docutils literal notranslate"><span class="pre">'ro'</span></code> specifies a red (<code class="docutils literal notranslate"><span class="pre">r</span></code>) circle (<code class="docutils literal notranslate"><span class="pre">o</span></code>). The string <code class="docutils literal notranslate"><span class="pre">'b-'</span></code> specifies a blue (<code class="docutils literal notranslate"><span class="pre">b</span></code>) solid line (<code class="docutils literal notranslate"><span class="pre">-</span></code>). The keyword argument <code class="docutils literal notranslate"><span class="pre">label</span></code> is set equal to a string that labels the data if the <code class="docutils literal notranslate"><span class="pre">legend</span></code> function is called subsequently.</div>
</div>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">xlabel(</span></code> <em>string</em> <code class="docutils literal notranslate"><span class="pre">)</span></code></div>
<div class="line">takes a string argument that specifies the label for the graph’s <span class="math notranslate nohighlight">\(x\)</span>-axis.</div>
</div>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">ylabel(</span></code> <em>string</em> <code class="docutils literal notranslate"><span class="pre">)</span></code></div>
<div class="line">takes a string argument that specifies the label for the graph’s <span class="math notranslate nohighlight">\(y\)</span>-axis.</div>
</div>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">legend()</span></code></div>
<div class="line">makes a legend for the data plotted. Each <span class="math notranslate nohighlight">\(x\)</span>-<span class="math notranslate nohighlight">\(y\)</span> data set is labeled using the string that was supplied by the <code class="docutils literal notranslate"><span class="pre">label</span></code> keyword in the <code class="docutils literal notranslate"><span class="pre">plot</span></code> function that graphed the data set. The <code class="docutils literal notranslate"><span class="pre">loc</span></code> keyword argument specifies the location of the legend.</div>
</div>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">axhline()</span></code></div>
<div class="line">draws a horizontal line across the width of the plot at <code class="docutils literal notranslate"><span class="pre">y=0</span></code>. The optional keyword argument <code class="docutils literal notranslate"><span class="pre">color</span></code> is a string that specifies the color of the line. The default color is black. The optional keyword argument <code class="docutils literal notranslate"><span class="pre">zorder</span></code> is an integer that specifies which plotting elements are in front of or behind others. By default, new plotting elements appear <em>on top of</em> previously plotted elements and have a value of <code class="docutils literal notranslate"><span class="pre">zorder=0</span></code>. By specifying <code class="docutils literal notranslate"><span class="pre">zorder=-1</span></code>, the horizontal line is plotted <em>behind</em>
all existing plot elements that have not be assigned an explicit <code class="docutils literal notranslate"><span class="pre">zorder</span></code> less than -1.</div>
</div>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">axvline()</span></code></div>
<div class="line">draws a vertical line from the top to the bottom of the plot at <code class="docutils literal notranslate"><span class="pre">x=0</span></code>. See <code class="docutils literal notranslate"><span class="pre">axhline()</span></code> for explanation of the arguments.</div>
</div>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">savefig(</span></code> <em>string</em> <code class="docutils literal notranslate"><span class="pre">)</span></code></div>
<div class="line">saves the figure to data data file with a name specified by the string argument. The string argument can also contain path information if you want to save the file so some place other than the default directory.</div>
</div>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">show()</span></code></div>
<div class="line">displays the plot on the computer screen. No screen output is produced before this function is called.</div>
</div>
</div></blockquote>
<p>single: MatPlotLib functions; figure single: MatPlotLib functions; plot single: MatPlotLib functions; xlabel, ylabel single: MatPlotLib functions; legend single: MatPlotLib functions; ayhline, axhline single: MatPlotLib functions; savefig single: MatPlotLib functions; show</p>
<p>To plot the solid blue line, the code uses the <code class="docutils literal notranslate"><span class="pre">'b-'</span></code> format specifier in the <code class="docutils literal notranslate"><span class="pre">plot</span></code> function call. It is important to understand that MatPlotLib draws <em>straight lines</em> between data points. Therefore, the curve will appear smooth only if the data in the NumPy arrays are sufficiently dense. If the space between data points is too large, the straight lines the <code class="docutils literal notranslate"><span class="pre">plot</span></code> function draws between data points will be visible. For plotting a typical function, something on the order of 100-200 data
points usually produces a smooth curve, depending on just how curvy the function is. On the other hand, only two points are required to draw a smooth straight line.</p>
<p>Detailed information about the MatPlotLib plotting functions are available online, starting with the site <a class="reference external" href="http://matplotlib.org/api/pyplot_summary.html">http://matplotlib.org/api/pyplot_summary.html</a>. The main MatPlotLib site is <a class="reference external" href="http://matplotlib.org/">http://matplotlib.org/</a>.</p>
<div class="section" id="Specifying-line-and-symbol-types-and-colors">
<h3><span class="section-number">5.2.1. </span>Specifying line and symbol types and colors<a class="headerlink" href="#Specifying-line-and-symbol-types-and-colors" title="Permalink to this headline">¶</a></h3>
<p>In the above example, we illustrated how to draw one line type (solid), one symbol type (circle), and two colors (blue and red). There are many more possibilities, which are specified in the tables below. The way it works is to specify a string consisting of one or more plotting format specifiers. There are two types of format specifiers, one for the line or symbol type and another for the color. It does not matter in which order the format specifiers are listed in the string. Examples are given
following the two tables. Try them out to make sure you understand how these plotting format specifiers work.</p>
<p>single: plots; line and symbol specifiers</p>
<p>The first table below shows the characters used to specify the line or symbol type that is used. If a line type is chosen, the lines are drawn between the data points. If a marker type is chosen, the a marker is plotted at each data point.</p>
<blockquote>
<div><table><colgroup><col style="width: 16%" /><col style="width: 33%" /><col style="width: 16%" /><col style="width: 33%" /></colgroup><thead><tr class="header"><th><p>character</p>
</th><th><p>description</p>
</th><th><p>character</p>
</th><th><p>description</p>
</th></tr></thead><tbody><tr class="odd"><td><ul class="simple">
<li></li>
</ul>
</td><td><p>solid line style</p>
</td><td><p>3</p>
</td><td><p>tri_left marker</p>
</td></tr><tr class="even"><td><p>–</p>
</td><td><p>dashed line style</p>
</td><td><p>4</p>
</td><td><p>tri_right marker</p>
</td></tr><tr class="odd"><td><p>-.</p>
</td><td><p>dash-dot line style</p>
</td><td><p>s</p>
</td><td><p>square marker</p>
</td></tr><tr class="even"><td><p>:</p>
</td><td><p>dotted line style</p>
</td><td><p>p</p>
</td><td><p>pentagon marker</p>
</td></tr><tr class="odd"><td><p>.</p>
</td><td><p>point marker</p>
</td><td><p>*</p>
</td><td><p>star marker</p>
</td></tr><tr class="even"><td><p>,</p>
</td><td><p>pixel marker</p>
</td><td><p>h</p>
</td><td><p>hexagon1 marker</p>
</td></tr><tr class="odd"><td><p>o</p>
</td><td><p>circle marker</p>
</td><td><p>H</p>
</td><td><p>hexagon2 marker</p>
</td></tr><tr class="even"><td><p>v</p>
</td><td><p>triangle_down marker</p>
</td><td><ul class="simple">
<li></li>
</ul>
</td><td><p>plus marker</p>
</td></tr><tr class="odd"><td><p>^</p>
</td><td><p>triangle_up marker</p>
</td><td><p>x</p>
</td><td><p>x marker</p>
</td></tr><tr class="even"><td><p>&lt;</p>
</td><td><p>triangle_left marker</p>
</td><td><p>D</p>
</td><td><p>diamond marker</p>
</td></tr><tr class="odd"><td><p>&gt;</p>
</td><td><p>triangle_right marker</p>
</td><td><p>d</p>
</td><td><p>thin_diamond marker</p>
</td></tr><tr class="even"><td><p>1</p>
</td><td><p>tri_down marker</p>
</td><td><p>|</p>
</td><td><p>vline marker</p>
</td></tr><tr class="odd"><td><p>2</p>
</td><td><p>tri_up marker</p>
</td><td><p>_</p>
</td><td><p>hline marker</p>
</td></tr></tbody></table><p>This second table gives the character codes for eight different colors. Many more are possible but the color specification becomes more complex. You can consult the web-based MatPlotLib documentation for further details.</p>
</div></blockquote>
<blockquote>
<div><table style="width:33%;"><colgroup><col style="width: 16%" /><col style="width: 16%" /></colgroup><thead><tr class="header"><th><p>character</p>
</th><th><p>color</p>
</th></tr></thead><tbody><tr class="odd"><td><p>b</p>
</td><td><p>blue</p>
</td></tr><tr class="even"><td><p>g</p>
</td><td><p>green</p>
</td></tr><tr class="odd"><td><p>r</p>
</td><td><p>red</p>
</td></tr><tr class="even"><td><p>c</p>
</td><td><p>cyan</p>
</td></tr><tr class="odd"><td><p>m</p>
</td><td><p>magenta</p>
</td></tr><tr class="even"><td><p>y</p>
</td><td><p>yellow</p>
</td></tr><tr class="odd"><td><p>k</p>
</td><td><p>black</p>
</td></tr><tr class="even"><td><p>w</p>
</td><td><p>white</p>
</td></tr></tbody></table><p>Here are some examples of how these format specifiers can be used:</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>    <span class="c1"># plots red circles</span>
<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;ks-&#39;</span><span class="p">)</span>   <span class="c1"># plot black squares connected by black lines</span>
<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;g^&#39;</span><span class="p">)</span>    <span class="c1"># plots green triangles that point up</span>

<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;k-&#39;</span><span class="p">)</span>    <span class="c1"># plots a black line between the points</span>
<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;ms&#39;</span><span class="p">)</span>    <span class="c1"># plots magenta squares</span>
</pre></div>
</div>
<p>You can also make two calls sequentially for added versatility. For example, by sequentially calling the last two plot calls, the plot produces magenta squares on top of black lines connecting the data points.</p>
<p>These format specifiers give rudimentary control of the plotting symbols and lines. MatPlotLib provides much more precise and detailed control of the plotting symbol size, line types, and colors using optional keyword arguments instead of the plotting format strings introduced above. For example, the following command creates a plot of large yellow diamond symbols with blue edges connected by a green dashed line:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span>
     <span class="n">markerfacecolor</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
     <span class="n">markeredgecolor</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Try it out! The online MatPlotLib documentation provides all the plotting format keyword arguments and their possible values.</p>
</div>
<div class="section" id="Error-bars">
<h3><span class="section-number">5.2.2. </span>Error bars<a class="headerlink" href="#Error-bars" title="Permalink to this headline">¶</a></h3>
<p>single: plots; error bars</p>
<p>When plotting experimental data it is customary to include error bars that indicate graphically the degree of uncertainty that exists in the measurement of each data point. The MatPlotLib function <code class="docutils literal notranslate"><span class="pre">errorbar</span></code> plots data with error bars attached. It can be used in a way that either replaces or augments the <code class="docutils literal notranslate"><span class="pre">plot</span></code> function. Both vertical and horizontal error bars can be displayed. The figure below illustrates the use of error bars.</p>
<figure><figcaption><p>Error Bars</p>
</figcaption></figure><p>When error bars are desired, you typically replace the <code class="docutils literal notranslate"><span class="pre">plot</span></code> function with the <code class="docutils literal notranslate"><span class="pre">errorbar</span></code> function. The first two arguments of the <code class="docutils literal notranslate"><span class="pre">errorbar</span></code> function are the <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> arrays to be plotted, just as for the <code class="docutils literal notranslate"><span class="pre">plot</span></code> function. The keyword <code class="docutils literal notranslate"><span class="pre">fmt</span></code> <em>must be used</em> to specify the format of the points to be plotted; the format specifiers are the same as for <code class="docutils literal notranslate"><span class="pre">plot</span></code>. The keywords <code class="docutils literal notranslate"><span class="pre">xerr</span></code> and <code class="docutils literal notranslate"><span class="pre">yerr</span></code> are used to specify the <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> error bars. Setting one or both of them
to a constant specifies one size for all the error bars. Alternatively, setting one or both of them equal to an array that has the same length as the <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> arrays allows you to give each data point an error bar with a different value. If you only want <span class="math notranslate nohighlight">\(y\)</span> error bars, then you should only specify the <code class="docutils literal notranslate"><span class="pre">yerr</span></code> keyword and omit the <code class="docutils literal notranslate"><span class="pre">xerr</span></code> keyword. The color of the error bars is set with the keyword <code class="docutils literal notranslate"><span class="pre">ecolor</span></code>.</p>
<p>The code and plot below illustrates how to make error bars and was used to make the above plot. Lines 14 and 15 contain the call to the <code class="docutils literal notranslate"><span class="pre">errorbar</span></code> function. The <span class="math notranslate nohighlight">\(x\)</span> error bars are all set to a constant value of 0.75, meaning that the error bars extend 0.75 to the left and 0.75 to the right of each data point. The <span class="math notranslate nohighlight">\(y\)</span> error bars are set equal to an array, which was read in from the data file containing the data to be plotted, so each data point has a different <span class="math notranslate nohighlight">\(y\)</span> error bar.
By the way, leaving out the <code class="docutils literal notranslate"><span class="pre">xerr</span></code> keyword argument in the <code class="docutils literal notranslate"><span class="pre">errorbar</span></code> function call below would mean that only the <span class="math notranslate nohighlight">\(y\)</span> error bars would be plotted.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># read data from file</span>
<span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">yerror</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;expDecayData.txt&#39;</span><span class="p">,</span> <span class="n">unpack</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># create theoretical fitting curve</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="mf">1.1</span><span class="o">+</span> <span class="mf">3.0</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="mf">10.0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># create plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;theory&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span>
             <span class="n">xerr</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">yerror</span><span class="p">,</span> <span class="n">ecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;transverse displacement&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>

<span class="c1"># save plot to file</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;ExpDecay.pdf&#39;</span><span class="p">)</span>

<span class="c1"># display plot on screen</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>We have more to say about the <code class="docutils literal notranslate"><span class="pre">errorbar</span></code> function in the sections on logarithmic plots. But the brief introduction given here should suffice for making most plots not involving logarithmic axes.</p>
</div>
<div class="section" id="Setting-plotting-limits-and-excluding-data">
<h3><span class="section-number">5.2.3. </span>Setting plotting limits and excluding data<a class="headerlink" href="#Setting-plotting-limits-and-excluding-data" title="Permalink to this headline">¶</a></h3>
<p>It turns out that you often want to restrict the range of numerical values over which you plot data or functions. In these cases you may need to manually specify the plotting window or, alternatively, you may wish to exclude data points that are outside some set of limits. Here we demonstrate methods for doing this.</p>
<div class="section" id="Setting-plotting-limits">
<h4><span class="section-number">5.2.3.1. </span>Setting plotting limits<a class="headerlink" href="#Setting-plotting-limits" title="Permalink to this headline">¶</a></h4>
<p>single: plots; setting axis limits</p>
<p>Suppose you want to plot the tangent function over the interval from 0 to 10. The following script offers an straightforward first attempt.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">10.</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">)</span>
<span class="n">ytan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">ytan</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure></figure><p>The resulting plot, shown above, doesn’t quite look like what you might have expected for <span class="math notranslate nohighlight">\(\tan\theta\)</span> <em>vs</em> <span class="math notranslate nohighlight">\(\theta\)</span>. The problem is that <span class="math notranslate nohighlight">\(\tan\theta\)</span> diverges at <span class="math notranslate nohighlight">\(\theta = \pi/2, 3\pi/2, 5\pi/2, ...\)</span>, which leads to large spikes in the plots as values in the <code class="docutils literal notranslate"><span class="pre">theta</span></code> array come near those values. Of course, we don’t want the plot to extend all the way out to <span class="math notranslate nohighlight">\(\pm\infty\)</span> in the <span class="math notranslate nohighlight">\(y\)</span> direction, nor can it. Instead, we would like the plot to extend far enough
that we get the idea of what is going on as <span class="math notranslate nohighlight">\(y\rightarrow\pm\infty\)</span>, but we would still like to see the behavior of the graph near <span class="math notranslate nohighlight">\(y=0\)</span>. We can restrict the range of <code class="docutils literal notranslate"><span class="pre">ytan</span></code> values that are plotted using the MatPlotLib function <code class="docutils literal notranslate"><span class="pre">ylim</span></code>, as we demonstrate in the script below.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">10.</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">)</span>
<span class="n">ytan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">ytan</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>         <span class="c1"># restricts range of y axis from -8 to +8</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>The figure produced by this script is shown below. The plot now looks much more like the familiar <span class="math notranslate nohighlight">\(\tan\theta\)</span> function we know. We have also include a call to the <code class="docutils literal notranslate"><span class="pre">axline</span></code> function to create an <span class="math notranslate nohighlight">\(x\)</span> axis.</p>
<figure><figcaption><p>Tangent function (with spurious lines)</p>
</figcaption></figure><p>The vertical blue lines at <span class="math notranslate nohighlight">\(\theta = \pi/2, 3\pi/2, 5\pi/2\)</span> should not appear in a plot of <span class="math notranslate nohighlight">\(\tan\theta\)</span> <em>vs</em> <span class="math notranslate nohighlight">\(\theta\)</span>. However, they do appear because the <code class="docutils literal notranslate"><span class="pre">plot</span></code> function simply draws lines between the data points in the <code class="docutils literal notranslate"><span class="pre">x</span></code>-<code class="docutils literal notranslate"><span class="pre">y</span></code> arrays provided in its arguments. Thus, <code class="docutils literal notranslate"><span class="pre">plot</span></code> draws a line between the very large positive and negative <code class="docutils literal notranslate"><span class="pre">ytan</span></code> values corresponding to the <code class="docutils literal notranslate"><span class="pre">theta</span></code> values on either side of <span class="math notranslate nohighlight">\(\pi/2\)</span> where <span class="math notranslate nohighlight">\(\tan\theta\)</span> diverges to
<span class="math notranslate nohighlight">\(\pm\infty\)</span>. It would be nice to exclude that line.</p>
</div>
<div class="section" id="Masked-arrays">
<h4><span class="section-number">5.2.3.2. </span>Masked arrays<a class="headerlink" href="#Masked-arrays" title="Permalink to this headline">¶</a></h4>
<p>single: plots; masked arrays single: masked arrays</p>
<p>We can exclude the data points near <span class="math notranslate nohighlight">\(\theta = \pi/2, 3\pi/2, 5\pi/2\)</span> in the above plot, and thus avoid drawing the nearly vertical lines at those points, using NumPy’s <em>masked array</em> feature. The code below shows how this is done and produces the graph below. The masked array feature is implemented in line 6 with a call to NumPy’s <code class="docutils literal notranslate"><span class="pre">masked_where</span></code> function in the sub-module <code class="docutils literal notranslate"><span class="pre">ma</span></code> (masked array). Therefore, it is called by writing <code class="docutils literal notranslate"><span class="pre">np.ma.masked_where</span></code>. The <code class="docutils literal notranslate"><span class="pre">masked_where</span></code> function works
as follows. The first argument sets the condition for masking elements of the array, which is specified by the second argument. In this case, the function says to mask all elements of the array <code class="docutils literal notranslate"><span class="pre">ytan</span></code> (the second argument) where the absolute value of <code class="docutils literal notranslate"><span class="pre">ytan</span></code> is greater than 20. The result is set equal to <code class="docutils literal notranslate"><span class="pre">ytanM</span></code>. When <code class="docutils literal notranslate"><span class="pre">ytanM</span></code> is plotted, MatPlotLib’s <code class="docutils literal notranslate"><span class="pre">plot</span></code> function omits all masked points from the plot. You can think of it as the <code class="docutils literal notranslate"><span class="pre">plot</span></code> function lifting the pen that is drawing the
line in the plot when it comes to the masked points in the array <code class="docutils literal notranslate"><span class="pre">ytanM</span></code>.</p>
<figure><figcaption><p>Tangent function</p>
</figcaption></figure><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">10.</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">)</span>
<span class="n">ytan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="n">ytanM</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ytan</span><span class="p">)</span><span class="o">&gt;</span><span class="mf">20.</span><span class="p">,</span> <span class="n">ytan</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">ytanM</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Subplots">
<h3><span class="section-number">5.2.4. </span>Subplots<a class="headerlink" href="#Subplots" title="Permalink to this headline">¶</a></h3>
<p>single: plots; subplots</p>
<p>Often you want to create two or more graphs and place them next to one another, generally because they are related to each other in some way. The plot below shows an example of such a plot. In the top graph, <span class="math notranslate nohighlight">\(\tan\theta\)</span> and <span class="math notranslate nohighlight">\(\sqrt{(8/\theta)^2-1}\)</span> <em>vs</em> <span class="math notranslate nohighlight">\(\theta\)</span> are plotted. The two curves cross each other at the points where <span class="math notranslate nohighlight">\(\tan\theta=\sqrt{(8/\theta)^2-1}\)</span>. In the bottom <span class="math notranslate nohighlight">\(\cot\theta\)</span> and <span class="math notranslate nohighlight">\(-\sqrt{(8/\theta)^2-1}\)</span> <em>vs</em> <span class="math notranslate nohighlight">\(\theta\)</span> are plotted. These two
curves cross each other at the points where <span class="math notranslate nohighlight">\(\cot\theta=-\sqrt{(8/\theta)^2-1}\)</span>.</p>
<figure><figcaption><p>Crossing functions</p>
</figcaption></figure><p>The code that produces this plot is provided below.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">8.</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="mf">8.</span><span class="o">/</span><span class="n">theta</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mf">1.</span><span class="p">)</span>
<span class="n">ytan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="n">ytan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ytan</span><span class="p">)</span><span class="o">&gt;</span><span class="mf">20.</span><span class="p">,</span> <span class="n">ytan</span><span class="p">)</span>
<span class="n">ycot</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="n">ycot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ycot</span><span class="p">)</span><span class="o">&gt;</span><span class="mf">20.</span><span class="p">,</span> <span class="n">ycot</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">ytan</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">3.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">5.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;theta&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;tan(theta)&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="o">-</span><span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">ycot</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">2.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;theta&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;cot(theta)&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>The function <code class="docutils literal notranslate"><span class="pre">subplot</span></code>, called on lines 13 and 24, creates the two subplots in the above figure. <code class="docutils literal notranslate"><span class="pre">subplot</span></code> has three arguments. The first specifies the number of rows that the figure space is to be divided into; on line 13, it’s two. The second specifies the number of columns that the figure space is to be divided into; on line 13, it’s one. The third argument specifies which rectangle the will contain the plot specified by the following function calls. Line 13 specifies that the plotting
commands that follow will be act on the first box. Line 24 specifies that the plotting commands that follow will be act on the second box.</p>
<p>We have also labeled the axes and included dashed vertical lines at the values of <span class="math notranslate nohighlight">\(\theta\)</span> where <span class="math notranslate nohighlight">\(\tan\theta\)</span> and <span class="math notranslate nohighlight">\(\cot\theta\)</span> diverge.</p>
</div>
</div>
<div class="section" id="Logarithmic-plots">
<h2><span class="section-number">5.3. </span>Logarithmic plots<a class="headerlink" href="#Logarithmic-plots" title="Permalink to this headline">¶</a></h2>
<p>single: plots; logarithmic axes</p>
<p>Data sets can span many orders of magnitude from fractional quantities much smaller than unity to values much larger than unity. In such cases it is often useful to plot the data on logarithmic axes.</p>
<div class="section" id="Semi-log-plots">
<h3><span class="section-number">5.3.1. </span>Semi-log plots<a class="headerlink" href="#Semi-log-plots" title="Permalink to this headline">¶</a></h3>
<p>single: plots; semi-log</p>
<p>For data sets that vary exponentially in the independent variable, it is often useful to use one or more logarithmic axes. Radioactive decay of unstable nuclei, for example, exhibits an exponential decrease in the number of particles emitted from the nuclei as a function of time. In the plot below, for example, we show the decay of the radioactive isotope Phosphorus-32 over a period of 6 months, where the radioactivity is measured once each week. Starting at a decay rate of nearly <span class="math notranslate nohighlight">\(10^4\)</span>
electrons (counts) per second, the decay rate diminishes to only about 1 count per second after about 6 months or 180 days. If we plot counts per second as a function of time on a normal plot, as we have done in the plot on the left below, then the count rate is indistinguishable from zero after about 100 days. On the other hand, if we use a logarithmic axis for the count rate, as we have done in the plot on the right below, then we can follow the count rate well past 100 days and can readily
distinguish it from zero. Moreover, if the data vary exponentially in time, then the data will fall along a straight line, as they do for the case of radioactive decay.</p>
<figure><figcaption><p>Semi-log plotting</p>
</figcaption></figure><p>MatPlotLib provides two functions for making semi-logarithmic plots, <code class="docutils literal notranslate"><span class="pre">semilogx</span></code> and <code class="docutils literal notranslate"><span class="pre">semilogy</span></code>, for creating plots with logarithmic <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> axes, with linear <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(x\)</span> axes, respectively. We illustrate their use in the program below, which made the above plots.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># read data from file</span>
<span class="n">time</span><span class="p">,</span> <span class="n">counts</span><span class="p">,</span> <span class="n">unc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;SemilogDemo.txt&#39;</span><span class="p">,</span> <span class="n">unpack</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># create theoretical fitting curve</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mf">20.2</span>      <span class="c1"># Phosphorus-32 half life = 14 days; tau = t_half/ln(2)</span>
<span class="n">N0</span> <span class="o">=</span> <span class="mf">8200.</span>       <span class="c1"># Initial count rate (per second)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="n">N0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="o">/</span><span class="n">tau</span><span class="p">)</span>

<span class="c1"># create plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;theory&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">counts</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time (days)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;counts per second&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;theory&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">counts</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time (days)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;counts per second&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="c1"># display plot on screen</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">semilogx</span></code> and <code class="docutils literal notranslate"><span class="pre">semilogy</span></code> functions work the same way as the <code class="docutils literal notranslate"><span class="pre">plot</span></code> function. You just use one or the other depending on which axis you want to be logarithmic.</p>
<div class="section" id="The-tight_layout()-function">
<h4><span class="section-number">5.3.1.1. </span>The <code class="docutils literal notranslate"><span class="pre">tight_layout()</span></code> function<a class="headerlink" href="#The-tight_layout()-function" title="Permalink to this headline">¶</a></h4>
<p>single: MatPlotLib functions; tight_layout</p>
<p>You may have noticed the <code class="docutils literal notranslate"><span class="pre">tight_layout()</span></code> function, called without arguments on line 30 of the program. This is a convenience function that adjusts the sizes of the plots to make room for the axes labels. If it is not called, the <span class="math notranslate nohighlight">\(y\)</span>-axis label of the right plot runs into the left plot. The <code class="docutils literal notranslate"><span class="pre">tight_layout()</span></code> function can also be useful in graphics windows with only one plot sometimes.</p>
</div>
</div>
<div class="section" id="Log-log-plots">
<h3><span class="section-number">5.3.2. </span>Log-log plots<a class="headerlink" href="#Log-log-plots" title="Permalink to this headline">¶</a></h3>
<p>single: plots; log-log</p>
<p>MatPlotLib can also make log-log or double-logarithmic plots using the function <code class="docutils literal notranslate"><span class="pre">loglog</span></code>. It is useful when both the <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> data span many orders of magnitude. Data that are described by a power law <span class="math notranslate nohighlight">\(y=Ax^b\)</span>, where <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(b\)</span> are constants, appear as straight lines when plotted on a log-log plot. Again, the <code class="docutils literal notranslate"><span class="pre">loglog</span></code> function works just like the <code class="docutils literal notranslate"><span class="pre">plot</span></code> function but with logarithmic axes.</p>
</div>
</div>
<div class="section" id="More-advanced-graphical-output">
<h2><span class="section-number">5.4. </span>More advanced graphical output<a class="headerlink" href="#More-advanced-graphical-output" title="Permalink to this headline">¶</a></h2>
<p>The plotting methods introduced in the previous sections are perfectly adequate for basic plotting and are therefore recommended for simple graphical output. Here, we introduce an alternative syntax that harnesses the full power of MatPlotLib. It gives the user more options and greater control. Perhaps the most efficient way to learn this alternative syntax is to look at an example. The figure below illustrating <code class="docutils literal notranslate"><span class="pre">MultPlotDemo</span></code> is produced by the following code:</p>
<figure><figcaption><p>Mulitple plots in the same window</p>
</figcaption></figure><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Demonstrates the following:</span>
<span class="c1">#     plotting logarithmic axes</span>
<span class="c1">#     user-defined functions</span>
<span class="c1">#     &quot;where&quot; function, NumPy array conditional</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Define the sinc function, with output for x=0 defined</span>
<span class="c1"># as a special case to avoid division by zero. The code</span>
<span class="c1"># below defining the sinc function is developed and</span>
<span class="c1"># explained in Chapter 7, Section 1.</span>
<span class="k">def</span> <span class="nf">s</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
  <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">x</span><span class="o">==</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">x</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">a</span>

<span class="c1"># create arrays for plotting</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">10.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">s</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

<span class="c1"># create a figure window</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="c1"># subplot: linear plot of exponential</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time (ms)&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;distance (mm)&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;exponential&#39;</span><span class="p">)</span>

<span class="c1"># subplot: semi-log plot of exponential</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time (ms)&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;distance (mm)&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;exponential&#39;</span><span class="p">)</span>

<span class="c1"># subplot: wide subplot of sinc function</span>
<span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;angle (deg)&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;electric field&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;sinc function&#39;</span><span class="p">)</span>

<span class="c1"># Adjusts white space to avoid collisions between subplots</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>After defining several arrays for plotting, the above program opens a figure window in line 23 with the statement :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
</pre></div>
</div>
<p>The MatPlotLib statement above creates a <strong>Figure</strong> object, assigns it the name <code class="docutils literal notranslate"><span class="pre">fig</span></code>, and opens a blank figure window. Thus, just as we give lists, arrays, and numbers variable names (<em>e.g.</em> <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">=</span> <span class="pre">[1,</span> <span class="pre">2,</span> <span class="pre">5,</span> <span class="pre">7]</span></code>, <code class="docutils literal notranslate"><span class="pre">dd</span> <span class="pre">=</span> <span class="pre">np.array([2.3,</span> <span class="pre">5.1,</span> <span class="pre">3.9])</span></code>, or <code class="docutils literal notranslate"><span class="pre">st</span> <span class="pre">=</span> <span class="pre">4.3</span></code>), we can give a figure object and the window in creates a name: here it is <code class="docutils literal notranslate"><span class="pre">fig</span></code>. In fact we can use the <code class="docutils literal notranslate"><span class="pre">figure</span></code> function to open up multiple figure objects with different figure windows. The statements :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">fig2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
</pre></div>
</div>
<p>open up two separate windows, one named <code class="docutils literal notranslate"><span class="pre">fig1</span></code> and the other <code class="docutils literal notranslate"><span class="pre">fig2</span></code>. We can then use the names <code class="docutils literal notranslate"><span class="pre">fig1</span></code> and <code class="docutils literal notranslate"><span class="pre">fig2</span></code> to plot things in either window. The <code class="docutils literal notranslate"><span class="pre">figure</span></code> function need not take any arguments if you are satisfied with the default settings such as the figure size and the background color. On the other hane, by supplying one or more keyword arguments, you can customize the figure size, the background color, and a few other properties. For example, in the program listing (line 23),
the keyword argument <code class="docutils literal notranslate"><span class="pre">figsize</span></code> sets the width and height of the figure window; the default size is <code class="docutils literal notranslate"><span class="pre">(8,</span> <span class="pre">6)</span></code>; in our program we set it to <code class="docutils literal notranslate"><span class="pre">(9,</span> <span class="pre">8)</span></code>, which is a bit wider and higher than the default size. In the example above, we also choose to open only a single window, hence the single <code class="docutils literal notranslate"><span class="pre">figure</span></code> call.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">fig.add_subplot(2,2,1)</span></code> in line 30 is a MatPlotLib function that divides the figure window into 2 rows (the first argument) and 2 columns (the second argument). The third argument creates a subplot in the first of the 4 subregions (<em>i.e.</em> of the 2 rows <span class="math notranslate nohighlight">\(\times\)</span> 2 columns) created by the <code class="docutils literal notranslate"><span class="pre">fig.add_subplot(2,2,1)</span></code> call. To see how this works, type the following code into a Python module and run it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>You should get a figure window with axes drawn in the upper left quadrant. The <code class="docutils literal notranslate"><span class="pre">fig.</span></code> prefix used with the <code class="docutils literal notranslate"><span class="pre">add_subplot(2,2,1)</span></code> function directs Python to draw these axes in the figure window named <code class="docutils literal notranslate"><span class="pre">fig</span></code>. If we had opened two figure windows, changing the prefix to correspond to the name of one or the other of the figure windows would direct the axes to be drawn in the appropriate window. Writing <code class="docutils literal notranslate"><span class="pre">ax1</span> <span class="pre">=</span> <span class="pre">fig.add_subplot(2,2,1)</span></code> assigns the name ax1 to the axes in the upper left quadrant of
the figure window.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">ax1.plot(x,</span> <span class="pre">y)</span></code> in line 27 directs Python to plot the previously-defined <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> arrays onto the axes named <code class="docutils literal notranslate"><span class="pre">ax1</span></code>. The <code class="docutils literal notranslate"><span class="pre">ax2</span> <span class="pre">=</span> <span class="pre">fig.add_subplot(2,2,2)</span></code> draws axes in the second, or upper right, quadrant of the figure window. The <code class="docutils literal notranslate"><span class="pre">ax3</span> <span class="pre">=</span> <span class="pre">fig.add_subplot(2,1,2)</span></code> divides the figure window into 2 rows (first argument) and 1 column (second argument), creates axes in the second or these two sections, and assigns those axes (<em>i.e.</em> that subplot) the name <code class="docutils literal notranslate"><span class="pre">ax3</span></code>. That is, it divides
the figure window into 2 halves, top and bottom, and then draws axes in the half number 2 (the third argument), or lower half of the figure window.</p>
<p>You may have noticed in above code that some of the function calls are a bit different from those used before: <code class="docutils literal notranslate"><span class="pre">xlabel(’time</span> <span class="pre">(ms)’)</span></code> becomes <code class="docutils literal notranslate"><span class="pre">set_xlabel(’time</span> <span class="pre">(ms)’)</span></code>, <code class="docutils literal notranslate"><span class="pre">title(’exponential’)</span></code> becomes <code class="docutils literal notranslate"><span class="pre">set_title(’exponential’)</span></code>, <em>etc.</em></p>
<p>The call <code class="docutils literal notranslate"><span class="pre">ax2.set_yscale('log')</span></code> sets the <span class="math notranslate nohighlight">\(y\)</span>-axes in the second plot to be logarithmic, thus creating a semi-log plot. Creating properly-labeled logarthmic axes like this is more straightforward with the advanced syntax illustrated in the above example.</p>
<p>Using the prefixes <code class="docutils literal notranslate"><span class="pre">ax1</span></code>, <code class="docutils literal notranslate"><span class="pre">ax2</span></code>, or <code class="docutils literal notranslate"><span class="pre">ax3</span></code>, direct graphical instructions to their respective subplots. By creating and specifying names for the different figure windows and subplots within them, you access the different plot windows more efficiently. For example, the following code makes four identical subplots in a single figure window using a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">fig</span> <span class="o">=</span> <span class="n">figure</span><span class="p">()</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="n">ax4</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">,</span> <span class="n">ax4</span><span class="p">]:</span>
   <span class="o">...</span><span class="p">:</span>     <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">],[</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">7</span><span class="p">]:</span> <span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="Exercises">
<h2><span class="section-number">5.5. </span>Exercises<a class="headerlink" href="#Exercises" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p>Plot the function <span class="math notranslate nohighlight">\(y=3x^2\)</span> for <span class="math notranslate nohighlight">\(-1 \le x \le 3\)</span> as a continuous line. Include enough points so that the curve you plot appears smooth. Label the axes <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>.</p></li>
<li><p>Plot the following function for <span class="math notranslate nohighlight">\(-15 \le x \le 15\)</span>:</p>
<div class="math notranslate nohighlight">
\[y = \frac{\cos x}{1+\frac{1}{5}x^2}\]</div>
<p>Include enough points so that the curve you plot appears smooth. Label the axes <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>.</p>
</li>
<li><p>Plot the functions <span class="math notranslate nohighlight">\(\sin x\)</span> and <span class="math notranslate nohighlight">\(\cos x\)</span> <em>vs</em> <span class="math notranslate nohighlight">\(x\)</span> on the same plot with <span class="math notranslate nohighlight">\(x\)</span> going from <span class="math notranslate nohighlight">\(-\pi\)</span> to <span class="math notranslate nohighlight">\(\pi\)</span>. Make sure the limits of <span class="math notranslate nohighlight">\(x\)</span>-axis do not extend beyond the limits of the data. Plot <span class="math notranslate nohighlight">\(\sin x\)</span> in the color green and <span class="math notranslate nohighlight">\(\cos x\)</span> in the color black and include a legend to label the two curves. Place the legend within the plot, but such that it does not cover either of the sine or cosine traces.</p></li>
<li><p>Create a data file with the data shown below.</p>
<ol class="arabic">
<li><p>Read the data into Python program and plot <span class="math notranslate nohighlight">\(t\)</span> <em>vs</em> <span class="math notranslate nohighlight">\(y\)</span> using circles for data points with error bars. Use the data in the <code class="docutils literal notranslate"><span class="pre">dy</span></code> column as the error estimates for the <span class="math notranslate nohighlight">\(y\)</span> data. Label the horizontal and vertical axes “time (s)” and “position (cm)”.</p></li>
<li><p>On the same graph, plot the function below as a smooth line. Make the line pass <em>behind</em> the data points.</p>
<div class="math notranslate nohighlight">
\[y(t) = \left[3 +
       \frac{1}{2}\sin\frac{\pi t}{5}\right]
       t\, e^{-t/10}\]</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Data</span> <span class="k">for</span> <span class="n">Exercise</span> <span class="mi">4</span>
<span class="n">Date</span><span class="p">:</span> <span class="mi">16</span><span class="o">-</span><span class="n">Aug</span><span class="o">-</span><span class="mi">2013</span>
<span class="n">Data</span> <span class="n">taken</span> <span class="n">by</span> <span class="n">Lauren</span> <span class="ow">and</span> <span class="n">John</span>

 <span class="n">t</span>      <span class="n">d</span>       <span class="n">dy</span>
 <span class="mf">1.0</span>    <span class="mf">2.94</span>    <span class="mf">0.7</span>
 <span class="mf">4.5</span>    <span class="mf">8.29</span>    <span class="mf">1.2</span>
 <span class="mf">8.0</span>    <span class="mf">9.36</span>    <span class="mf">1.2</span>
<span class="mf">11.5</span>   <span class="mf">11.60</span>    <span class="mf">1.4</span>
<span class="mf">15.0</span>    <span class="mf">9.32</span>    <span class="mf">1.3</span>
<span class="mf">18.5</span>    <span class="mf">7.75</span>    <span class="mf">1.1</span>
<span class="mf">22.0</span>    <span class="mf">8.06</span>    <span class="mf">1.2</span>
<span class="mf">25.5</span>    <span class="mf">5.60</span>    <span class="mf">1.0</span>
<span class="mf">29.0</span>    <span class="mf">4.50</span>    <span class="mf">0.8</span>
<span class="mf">32.5</span>    <span class="mf">4.01</span>    <span class="mf">0.8</span>
<span class="mf">36.0</span>    <span class="mf">2.62</span>    <span class="mf">0.7</span>
<span class="mf">39.5</span>    <span class="mf">1.70</span>    <span class="mf">0.6</span>
<span class="mf">43.0</span>    <span class="mf">2.03</span>    <span class="mf">0.6</span>
</pre></div>
</div>
</li>
</ol>
</li>
<li><p>Use MatPlotLib’s function <code class="docutils literal notranslate"><span class="pre">hist</span></code> along with NumPy’s function’s <code class="docutils literal notranslate"><span class="pre">random.rand</span></code> and <code class="docutils literal notranslate"><span class="pre">random.randn</span></code> to create the histogram graphs shown in Fig. <code class="docutils literal notranslate"><span class="pre">fig-randhistos</span></code></p></li>
<li><p>Plot force <em>vs</em> distance with error bars using the following data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.64</span><span class="p">,</span> <span class="mf">0.91</span><span class="p">,</span> <span class="mf">1.26</span><span class="p">,</span> <span class="mf">1.41</span><span class="p">,</span> <span class="mf">1.66</span><span class="p">,</span> <span class="mf">1.90</span><span class="p">,</span> <span class="mf">2.18</span><span class="p">])</span>
<span class="n">f</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.4</span><span class="p">,</span> <span class="mf">1.65</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">3.95</span><span class="p">,</span> <span class="mf">4.3</span><span class="p">,</span> <span class="mf">5.20</span><span class="p">,</span> <span class="mf">6.85</span><span class="p">,</span> <span class="mf">7.4</span><span class="p">])</span>
<span class="n">df</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">])</span>
</pre></div>
</div>
<p>Your plot should also include a visual straight “best fit” to the data as well as visual “fits” that give the smallest and largest slopes consistent with the data. Note, you only need two points to define a straight line so the straight lines you draw on the plot should be arrays of length 2 and no longer. All of your fitted lines should lie <em>behind</em> the data. Try to make your plot look like the one below. <em>In addition</em>, add a legend to your plot the gives the slope with its uncertainty
obtained from your visual fits to the data.</p>
<figure></figure><p>The web page <a class="reference external" href="http://matplotlib.org/api/pyplot_summary.html">http://matplotlib.org/api/pyplot_summary.html</a> gives a summary of the main plotting commands available in MatPlotLib. The two important ones here are <code class="docutils literal notranslate"><span class="pre">plot</span></code> and <code class="docutils literal notranslate"><span class="pre">errorbar</span></code>, which make regular plots and plots with error bars, respectively. You will find the following keyword arguments useful: <code class="docutils literal notranslate"><span class="pre">yerr</span></code>, <code class="docutils literal notranslate"><span class="pre">ls</span></code>, <code class="docutils literal notranslate"><span class="pre">marker</span></code>, <code class="docutils literal notranslate"><span class="pre">mfc</span></code>, <code class="docutils literal notranslate"><span class="pre">mec</span></code>, <code class="docutils literal notranslate"><span class="pre">ms</span></code>, and <code class="docutils literal notranslate"><span class="pre">ecolor</span></code>, which you can find described by clicking on the <code class="docutils literal notranslate"><span class="pre">errorbar</span></code> function link on the web page cited above.</p>
</li>
<li><p>The data file below shows data obtained for the displacement (position) <em>vs</em> time of a falling object, together with the estimated uncertainty in the displacement.</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Measurements</span> <span class="n">of</span> <span class="n">fall</span> <span class="n">velocity</span> <span class="n">vs</span> <span class="n">time</span>
<span class="n">Taken</span> <span class="n">by</span> <span class="n">A</span><span class="o">.</span><span class="n">P</span><span class="o">.</span> <span class="n">Crawford</span> <span class="ow">and</span> <span class="n">S</span><span class="o">.</span><span class="n">M</span><span class="o">.</span> <span class="n">Torres</span>
<span class="mi">19</span><span class="o">-</span><span class="n">Sep</span><span class="o">-</span><span class="mi">13</span>
<span class="n">time</span> <span class="p">(</span><span class="n">s</span><span class="p">)</span>    <span class="n">position</span> <span class="p">(</span><span class="n">m</span><span class="p">)</span>    <span class="n">uncertainty</span> <span class="p">(</span><span class="n">m</span><span class="p">)</span>
 <span class="mf">0.0</span>            <span class="mf">0.0</span>             <span class="mf">0.04</span>
 <span class="mf">0.5</span>            <span class="mf">1.3</span>             <span class="mf">0.12</span>
 <span class="mf">1.0</span>            <span class="mf">5.1</span>             <span class="mf">0.2</span>
 <span class="mf">1.5</span>           <span class="mf">10.9</span>             <span class="mf">0.3</span>
 <span class="mf">2.0</span>           <span class="mf">18.9</span>             <span class="mf">0.4</span>
 <span class="mf">2.5</span>           <span class="mf">28.7</span>             <span class="mf">0.4</span>
 <span class="mf">3.0</span>           <span class="mf">40.3</span>             <span class="mf">0.5</span>
 <span class="mf">3.5</span>           <span class="mf">53.1</span>             <span class="mf">0.6</span>
 <span class="mf">4.0</span>           <span class="mf">67.5</span>             <span class="mf">0.6</span>
 <span class="mf">4.5</span>           <span class="mf">82.3</span>             <span class="mf">0.6</span>
 <span class="mf">5.0</span>           <span class="mf">97.6</span>             <span class="mf">0.7</span>
 <span class="mf">5.5</span>          <span class="mf">113.8</span>             <span class="mf">0.7</span>
 <span class="mf">6.0</span>          <span class="mf">131.2</span>             <span class="mf">0.7</span>
 <span class="mf">6.5</span>          <span class="mf">148.5</span>             <span class="mf">0.7</span>
 <span class="mf">7.0</span>          <span class="mf">166.2</span>             <span class="mf">0.7</span>
 <span class="mf">7.5</span>          <span class="mf">184.2</span>             <span class="mf">0.7</span>
 <span class="mf">8.0</span>          <span class="mf">201.6</span>             <span class="mf">0.7</span>
 <span class="mf">8.5</span>          <span class="mf">220.1</span>             <span class="mf">0.7</span>
 <span class="mf">9.0</span>          <span class="mf">238.3</span>             <span class="mf">0.7</span>
 <span class="mf">9.5</span>          <span class="mf">256.5</span>             <span class="mf">0.7</span>
<span class="mf">10.0</span>          <span class="mf">275.6</span>             <span class="mf">0.8</span>
</pre></div>
</div>
</div></blockquote>
<ol class="arabic simple">
<li><p>Use these data to calculate the velocity and acceleration (in a Python program <code class="docutils literal notranslate"><span class="pre">.py</span></code> file), together with their uncertainties propagated from the displacement <em>vs</em> time uncertainties. Be sure to calculate time arrays corresponding the midpoint in time between the two displacements or velocities for the velocity and acceleration arrays, respectively.</p></li>
<li><p>In a single window frame, make three vertically stacked plots of the displacement, velocity, and acceleration <em>vs</em> time. Show the error bars on the different plots. Make sure that the time axes of all three plots cover the same range of times. Why do the relative sizes of the error bars grow progressively greater as one progresses from displacement to velocity to acceleration?</p></li>
</ol>
</li>
</ol>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../chap6/chap6_loopsconds.html" class="btn btn-neutral float-right" title="6. Conditionals and Loops" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../chap4/chap4_io.html" class="btn btn-neutral float-left" title="4. Input and Output" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright David J Pine

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>