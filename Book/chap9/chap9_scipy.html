

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>9. Numerical Routines: SciPy and NumPy &mdash; Scientific python tutorial 1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="prev" title="8. Curve Fitting" href="../chap8/chap8_fitting.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Scientific python tutorial
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../chap1/chap1_intro.html">1. Chapter 1: Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chap2/chap2_basics.html">2. Chapter 2: First Steps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chap3/chap3_arrays.html">3. Chapter 3: Arrays</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chap4/chap4_io.html">4. Chapter 4: Input and Output</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chap5/chap5_plot.html">5. Chapter 5: Plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chap6/chap6_loopsconds.html">6. Chapter 6: Flow control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chap7/chap7_funcs.html">7. Chapter 7: Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chap8/chap8_fitting.html">8. Chapter 8: Curve Fitting</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">9. Chapter 9: Scipy</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#special-functions">9.1. Special functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#numerical-integration">9.2. Numerical integration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#single-integrals">9.2.1. Single integrals</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#integrating-polynomials">9.2.1.1. Integrating polynomials</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#double-integrals">9.2.2. Double integrals</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#other-integration-routines">9.2.2.1. Other integration routines</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#solving-odes">9.3. Solving ODEs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#discrete-fast-fourier-transforms">9.4. Discrete (fast) Fourier transforms</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#continuous-and-discrete-fourier-transforms">9.4.1. Continuous and discrete Fourier transforms</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-scipy-fft-library">9.4.2. The SciPy FFT library</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#linear-algebra">9.5. Linear algebra</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#basic-computations-in-linear-algebra">9.5.1. Basic computations in linear algebra</a></li>
<li class="toctree-l3"><a class="reference internal" href="#solving-systems-of-linear-equations">9.5.2. Solving systems of linear equations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#eigenvalue-problems">9.5.3. Eigenvalue problems</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#generalized-eigenvalue-problem">9.5.3.1. Generalized eigenvalue problem</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hermitian-and-banded-matrices">9.5.3.2. Hermitian and banded matrices</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#solving-non-linear-equations">9.6. Solving non-linear equations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#single-equations-of-a-single-variable">9.6.1. Single equations of a single variable</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#brent-method">9.6.1.1. Brent method</a></li>
<li class="toctree-l4"><a class="reference internal" href="#other-methods-for-solving-equations-of-a-single-variable">9.6.1.2. Other methods for solving equations of a single variable</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#solving-systems-of-nonlinear-equations">9.6.2. Solving systems of nonlinear equations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#exercises">9.7. Exercises</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Scientific python tutorial</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li><span class="section-number">9. </span>Numerical Routines: SciPy and NumPy</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/Book/chap9/chap9_scipy.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="numerical-routines-scipy-and-numpy">
<span id="chap9"></span><h1><span class="section-number">9. </span>Numerical Routines: SciPy and NumPy<a class="headerlink" href="#numerical-routines-scipy-and-numpy" title="Permalink to this headline">¶</a></h1>
<p>SciPy is a Python library of mathematical routines.  Many of the SciPy routines are Python “wrappers”, that is, Python routines that provide a Python interface for numerical libraries and routines originally written in Fortran, C, or C++.  Thus, SciPy lets you take advantage of the decades of work that has gone into creating and optimizing numerical routines for science and engineering.  Because the Fortran, C, or C++ code that Python accesses is compiled, these routines typically run very fast.  Therefore, there is no real downside—no speed penalty—for using Python in these cases.</p>
<p id="index-0">We have already encountered one of SciPy’s routines, <code class="docutils literal notranslate"><span class="pre">scipy.optimize.leastsq</span></code>, for fitting nonlinear functions to experimental data, which was introduced in the the chapter on <a class="reference internal" href="../chap8/chap8_fitting.html#chap8"><span class="std std-ref">Curve Fitting</span></a>.   Here we will provide a further introduction to a number of other SciPy packages, in particular those on special functions, numerical integration, including routines for numerically solving ordinary differential equations (ODEs), discrete Fourier transforms, linear algebra, and solving non-linear equations.  Our introduction to these capabilities does not include extensive background on the numerical methods employed; that is a topic for another text.  Here we simply introduce the SciPy routines for performing some of the more frequently required numerical tasks.</p>
<p>One final note:  SciPy makes extensive use of NumPy arrays, so NumPy should always be imported with SciPy</p>
<div class="section" id="special-functions">
<span id="specfunc"></span><span id="index-1"></span><h2><span class="section-number">9.1. </span>Special functions<a class="headerlink" href="#special-functions" title="Permalink to this headline">¶</a></h2>
<p>SciPy provides a plethora of special functions, including Bessel functions (and routines for finding their zeros, derivatives, and integrals), error functions, the gamma function, Legendre, Laguerre, and Hermite polynomials (and other polynomial functions), Mathieu functions, many statistical functions, and a number of other functions.  Most are contained in the <code class="docutils literal notranslate"><span class="pre">scipy.special</span></code> library, and each has its own special arguments and syntax, depending on the vagaries of the particular function.  We demonstrate a number of them in the code below that produces a plot of the different functions called.  For more information, you should consult the SciPy web site on the <code class="docutils literal notranslate"><span class="pre">scipy.special</span></code> library.</p>
<blockquote>
<div><div class="figure align-center" id="id1">
<span id="fig-specfuncplots"></span><a class="reference internal image-reference" href="../../_images/specFuncPlots.jpg"><img alt="../../_images/specFuncPlots.jpg" src="../../_images/specFuncPlots.jpg" style="width: 800.0px; height: 711.0px;" /></a>
<p class="caption"><span class="caption-text">Plots of a few selected special functions</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
</div></blockquote>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84</pre></div></td><td class="code"><div class="highlight"><pre><span></span>    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="kn">import</span> <span class="nn">scipy.special</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

    <span class="c1"># create a figure window</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

    <span class="c1"># create arrays for a few Bessel functions and plot them</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
    <span class="n">j0</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">jn</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="n">j1</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">jn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="n">y0</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">yn</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="n">y1</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">yn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">321</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">j0</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span><span class="n">j1</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span><span class="n">y1</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span><span class="s1">&#39;Bessel&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span>
         <span class="n">transform</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>

    <span class="c1"># gamma function</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">3.5</span><span class="p">,</span> <span class="mf">6.</span><span class="p">,</span> <span class="mi">3601</span><span class="p">)</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_outside</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">322</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">g</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">3.5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span><span class="s1">&#39;Gamma&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span>
         <span class="n">transform</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>

    <span class="c1"># error function</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
    <span class="n">ef</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">erf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">323</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">ef</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.1</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span><span class="s1">&#39;Error&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span>
         <span class="n">transform</span> <span class="o">=</span> <span class="n">ax3</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>

    <span class="c1"># Airy function</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
    <span class="n">ai</span><span class="p">,</span> <span class="n">aip</span><span class="p">,</span> <span class="n">bi</span><span class="p">,</span> <span class="n">bip</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">airy</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">ax4</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">324</span><span class="p">)</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">ai</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span><span class="n">bi</span><span class="p">)</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.6</span><span class="p">)</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span><span class="s1">&#39;Airy&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span>
         <span class="n">transform</span> <span class="o">=</span> <span class="n">ax4</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>

    <span class="c1"># Legendre polynomials</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
    <span class="n">lp0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">legendre</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">x</span><span class="p">)</span>
    <span class="n">lp1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">legendre</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">x</span><span class="p">)</span>
    <span class="n">lp2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">legendre</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">x</span><span class="p">)</span>
    <span class="n">lp3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">legendre</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">x</span><span class="p">)</span>
    <span class="n">ax5</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">325</span><span class="p">)</span>
    <span class="n">ax5</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">lp0</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span><span class="n">lp1</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span><span class="n">lp2</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span><span class="n">lp3</span><span class="p">)</span>
    <span class="n">ax5</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax5</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax5</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mf">1.1</span><span class="p">)</span>
    <span class="n">ax5</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span><span class="s1">&#39;Legendre&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span>
         <span class="n">transform</span> <span class="o">=</span> <span class="n">ax5</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>

    <span class="c1"># Laguerre polynomials</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
    <span class="n">lg0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">laguerre</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">x</span><span class="p">)</span>
    <span class="n">lg1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">laguerre</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">x</span><span class="p">)</span>
    <span class="n">lg2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">laguerre</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">x</span><span class="p">)</span>
    <span class="n">lg3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">laguerre</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">x</span><span class="p">)</span>
    <span class="n">ax6</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">326</span><span class="p">)</span>
    <span class="n">ax6</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">lg0</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span><span class="n">lg1</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span><span class="n">lg2</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span><span class="n">lg3</span><span class="p">)</span>
    <span class="n">ax6</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax6</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax6</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">ax6</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">ax6</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span><span class="s1">&#39;Laguerre&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span>
         <span class="n">transform</span> <span class="o">=</span> <span class="n">ax6</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>The arguments of the different functions depend, of course, on the nature of the particular function.  For example, the first argument of the two types of Bessel functions called in lines 10-13 is the so-called <em>order</em> of the  Bessel function, and the second argument is the independent variable.  The Gamma and Error functions take one argument each and produce one output.  The Airy function takes only one input argument, but returns four outputs, which correspond the two Airy functions, normally designated <span class="math notranslate nohighlight">\(\mathrm{Ai}(x)\)</span> and <span class="math notranslate nohighlight">\(\mathrm{Bi}(x)\)</span>, and their derivatives <span class="math notranslate nohighlight">\(\mathrm{Ai}^\prime(x)\)</span> and <span class="math notranslate nohighlight">\(\mathrm{Bi}^\prime(x)\)</span>.  The plot shows only <span class="math notranslate nohighlight">\(\mathrm{Ai}(x)\)</span> and <span class="math notranslate nohighlight">\(\mathrm{Bi}(x)\)</span>.</p>
<p>The polynomial functions shown have a special syntax that uses NumPy’s <code class="docutils literal notranslate"><span class="pre">polyval</span></code> function for generating polynomials.  If <code class="docutils literal notranslate"><span class="pre">p</span></code> is a list or array of <code class="docutils literal notranslate"><span class="pre">N</span></code> numbers and <code class="docutils literal notranslate"><span class="pre">x</span></code> is an array, then</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">polyval</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="o">...</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span>
                 <span class="n">p</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>For example, if <code class="docutils literal notranslate"><span class="pre">p</span> <span class="pre">=</span> <span class="pre">[2.0,</span> <span class="pre">5.0,</span> <span class="pre">1.0]</span></code>, <code class="docutils literal notranslate"><span class="pre">polyval(p,</span> <span class="pre">x)</span></code> generates the following quadratic polynomial: <span class="math notranslate nohighlight">\(2x^2 + 5x +1\)</span>.</p>
<p>SciPy’s <code class="docutils literal notranslate"><span class="pre">special.legendre(n)</span></code> and <code class="docutils literal notranslate"><span class="pre">special.laguerre(n)</span></code> functions output the coefficients <code class="docutils literal notranslate"><span class="pre">p</span></code> needed in <code class="docutils literal notranslate"><span class="pre">polyval</span></code> to produce the <span class="math notranslate nohighlight">\(n^\mathrm{th}\)</span>-order Legendre and Laguerre polynomials, respectively.  The <code class="docutils literal notranslate"><span class="pre">scipy.special</span></code> library has functions that specify many other polynomial functions in this same way.</p>
</div>
<div class="section" id="numerical-integration">
<span id="numericalintegration"></span><span id="index-2"></span><h2><span class="section-number">9.2. </span>Numerical integration<a class="headerlink" href="#numerical-integration" title="Permalink to this headline">¶</a></h2>
<p>When a function cannot be integrated analytically, or is very difficult to integrate analytically, one generally turns to numerical integration methods.   SciPy has a number of routines for performing numerical integration.  Most of them are found in the same <code class="docutils literal notranslate"><span class="pre">scipy.integrate</span></code> library.  We list them here for reference.</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 21%" />
<col style="width: 79%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Function</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">quad</span></code></p></td>
<td><p>single integration</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dblquad</span></code></p></td>
<td><p>double integration</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">tplquad</span></code></p></td>
<td><p>triple integration</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">nquad</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(n\)</span>-fold multiple integration</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">fixed_quad</span></code></p></td>
<td><p>Gaussian quadrature, order n</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">quadrature</span></code></p></td>
<td><p>Gaussian quadrature to tolerance</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">romberg</span></code></p></td>
<td><p>Romberg integration</p></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">trapz</span></code></p></td>
<td><p>trapezoidal rule</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">cumtrapz</span></code></p></td>
<td><p>trapezoidal rule to cumulatively compute integral</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">simps</span></code></p></td>
<td><p>Simpson’s rule</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">romb</span></code></p></td>
<td><p>Romberg integration</p></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">polyint</span></code></p></td>
<td><p>Analytical polynomial integration (NumPy)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">poly1d</span></code></p></td>
<td><p>Helper function for <code class="docutils literal notranslate"><span class="pre">polyint</span></code> (NumPy)</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="section" id="single-integrals">
<h3><span class="section-number">9.2.1. </span>Single integrals<a class="headerlink" href="#single-integrals" title="Permalink to this headline">¶</a></h3>
<p>The function <code class="docutils literal notranslate"><span class="pre">quad</span></code> is the workhorse of SciPy’s integration functions. Numerical integration is sometimes called <em>quadrature</em>, hence the name.  It is normally the default choice for performing single integrals of a function <span class="math notranslate nohighlight">\(f(x)\)</span> over a given fixed range from <span class="math notranslate nohighlight">\(a\)</span> to <span class="math notranslate nohighlight">\(b\)</span></p>
<div class="math notranslate nohighlight">
\[\int_a^b f(x)\, dx\]</div>
<p>The general form of <code class="docutils literal notranslate"><span class="pre">quad</span></code> is <code class="docutils literal notranslate"><span class="pre">scipy.integrate.quad(f,</span> <span class="pre">a,</span> <span class="pre">b)</span></code>, where <code class="docutils literal notranslate"><span class="pre">f</span></code> is the name of the function to be integrated and <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> are the lower and upper limits, respectively.  The routine uses <em>adaptive quadrature</em> methods to numerically evaluate integrals, meaning it successively refines the subintervals (makes them smaller) until a desired level of numerical precision is achieved.  For the <code class="docutils literal notranslate"><span class="pre">quad</span></code> routine, this is about <span class="math notranslate nohighlight">\(10^{-8}\)</span>, although it usually does even better.</p>
<p>As an example, let’s integrate a Gaussian function over the range from 0 to 1</p>
<div class="math notranslate nohighlight">
\[\int_0^1 e^{-x^2} dx\]</div>
<p>We first need to define the function <span class="math notranslate nohighlight">\(f(x)=e^{-x^2}\)</span>, which we do using a lambda expression, and then we call the function <code class="docutils literal notranslate"><span class="pre">quad</span></code> to perform the integration.</p>
<div class="highlight-ipython notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="kn">import</span> <span class="nn">scipy.integrate</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">scipy</span><span class="o">.</span><span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="p">(</span><span class="mf">0.7468241328124271</span><span class="p">,</span> <span class="mf">8.291413475940725e-15</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>The function call <code class="docutils literal notranslate"><span class="pre">scipy.integrate.quad(f,</span> <span class="pre">0,</span> <span class="pre">1)</span></code> returns two numbers.  The first is <code class="docutils literal notranslate"><span class="pre">0.7468...</span></code>, which is the value of the integral, and the second is <code class="docutils literal notranslate"><span class="pre">8.29...e-15</span></code>, which is an estimate of the absolute error in the value of the integral, which we see is quite small compared to <code class="docutils literal notranslate"><span class="pre">0.7468</span></code>.</p>
<p>Because <code class="docutils literal notranslate"><span class="pre">quad</span></code> requires a function <em>name</em> as its first argument, we can’t simply use the expression <code class="docutils literal notranslate"><span class="pre">exp(-x**2)</span></code>.  On the other hand, we could use the usual <code class="docutils literal notranslate"><span class="pre">def</span></code> statement to create a normal function, and then use the name of that function in <code class="docutils literal notranslate"><span class="pre">quad</span></code>.  However, it’s simpler here to use a lambda expression.  In fact, we can just put the lambda expression directly into the first argument, as illustrated here</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">scipy</span><span class="o">.</span><span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="p">(</span><span class="mf">0.7468241328124271</span><span class="p">,</span> <span class="mf">8.291413475940725e-15</span><span class="p">)</span>
</pre></div>
</div>
<p>That works too!  Thus we see a <code class="docutils literal notranslate"><span class="pre">lambda</span></code> expression used as an <em>anonymous function</em>, a function with no name, as promised in the section <a class="reference internal" href="../chap7/chap7_funcs.html#lambda"><span class="std std-ref">Anonymous functions (lambda)</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">quad</span></code> function accepts positive and negative infinity as limits.</p>
</div>
<div class="highlight-ipython notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="n">scipy</span><span class="o">.</span><span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">inf</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="p">(</span><span class="mf">0.8862269254527579</span><span class="p">,</span> <span class="mf">7.101318390472462e-09</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="n">scipy</span><span class="o">.</span><span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="n">inf</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="p">(</span><span class="mf">1.6330510582651852</span><span class="p">,</span> <span class="mf">3.669607414547701e-11</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>The <code class="docutils literal notranslate"><span class="pre">quad</span></code> function handles infinite limits just fine. The absolute errors are somewhat larger but still well within acceptable bounds for practical work.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">quad</span></code> function can integrate standard predefined NumPy functions of a single variable, like <code class="docutils literal notranslate"><span class="pre">exp</span></code>, <code class="docutils literal notranslate"><span class="pre">sin</span></code>, and <code class="docutils literal notranslate"><span class="pre">cos</span></code>.</p>
<div class="highlight-ipython notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">7</span><span class="p">]:</span> <span class="n">scipy</span><span class="o">.</span><span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">7</span><span class="p">]:</span> <span class="p">(</span><span class="mf">1.7182818284590453</span><span class="p">,</span> <span class="mf">1.9076760487502457e-14</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">8</span><span class="p">]:</span> <span class="n">scipy</span><span class="o">.</span><span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">sin</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">8</span><span class="p">]:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">2.707864644566304e-15</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">9</span><span class="p">]:</span> <span class="n">scipy</span><span class="o">.</span><span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">cos</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">9</span><span class="p">]:</span> <span class="p">(</span><span class="mf">0.9588510772084061</span><span class="p">,</span> <span class="mf">1.0645385431034061e-14</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>Let’s integrate the first order Bessel function of the first kind, usually denoted <span class="math notranslate nohighlight">\(J_1(x)\)</span>, over the interval from 0 to 5.  Here is how we do it, using <code class="docutils literal notranslate"><span class="pre">scipy.special.jn(v,x)</span></code> where <code class="docutils literal notranslate"><span class="pre">v</span></code> is the (real) order of the Bessel function:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">10</span><span class="p">]:</span> <span class="kn">import</span> <span class="nn">scipy.special</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">11</span><span class="p">]:</span> <span class="n">scipy</span><span class="o">.</span><span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">scipy</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">jn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">11</span><span class="p">]:</span> <span class="p">(</span><span class="mf">1.177596771314338</span><span class="p">,</span> <span class="mf">1.8083362065765924e-14</span><span class="p">)</span>
</pre></div>
</div>
<p>Because the SciPy function <code class="docutils literal notranslate"><span class="pre">scipy.special.jn(v,</span> <span class="pre">x)</span></code> is a function of two variables, <code class="docutils literal notranslate"><span class="pre">v</span></code> and <code class="docutils literal notranslate"><span class="pre">x</span></code>, we cannot use the function name <code class="docutils literal notranslate"><span class="pre">scipy.special.jn</span></code> in <code class="docutils literal notranslate"><span class="pre">quad</span></code>.  So we use a <code class="docutils literal notranslate"><span class="pre">lambda</span></code> expression, which is a function of only one variable, <code class="docutils literal notranslate"><span class="pre">x</span></code>, because we have set the <code class="docutils literal notranslate"><span class="pre">v</span></code> argument equal to 1.</p>
<div class="section" id="integrating-polynomials">
<span id="index-3"></span><h4><span class="section-number">9.2.1.1. </span>Integrating polynomials<a class="headerlink" href="#integrating-polynomials" title="Permalink to this headline">¶</a></h4>
<p>Working in concert with the NumPy <code class="docutils literal notranslate"><span class="pre">poly1d</span></code>, the NumPy function <code class="docutils literal notranslate"><span class="pre">polyint</span></code> takes the <span class="math notranslate nohighlight">\(n^\mathrm{th}\)</span> antiderivative of a polynomial and can be used to evaluate definite integrals.  The function <code class="docutils literal notranslate"><span class="pre">poly1d</span></code> essentially does the same thing as <code class="docutils literal notranslate"><span class="pre">polyval</span></code> that we encountered in the section <a class="reference internal" href="#specfunc"><span class="std std-ref">Special functions</span></a>, but with a different syntax.  Suppose we want to make the polynomial function <span class="math notranslate nohighlight">\(p(x) = 2x^2 + 5x +1\)</span>.  Then we write</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">12</span><span class="p">]:</span> <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="n">p</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="n">poly1d</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<p>The polynomial <span class="math notranslate nohighlight">\(p(x) = 2x^2 + 5x +1\)</span> is evaluated using the syntax <code class="docutils literal notranslate"><span class="pre">p(x)</span></code>.  Below, we evaluate the polynomial at three different values of <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">14</span><span class="p">]:</span> <span class="n">p</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">p</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">p</span><span class="p">(</span><span class="mf">3.5</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">14</span><span class="p">]:</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mf">43.0</span><span class="p">)</span>
</pre></div>
</div>
<p>Thus <code class="docutils literal notranslate"><span class="pre">polyval</span></code> allows us to define the function <span class="math notranslate nohighlight">\(p(x) = 2x^2 + 5x +1\)</span>.  Now the antiderivative of <span class="math notranslate nohighlight">\(p(x) = 2x^2 + 5x +1\)</span> is <span class="math notranslate nohighlight">\(P(x) = \frac{2}{3}x^3 + \frac{5}{2}x^2 +x+C\)</span> where <span class="math notranslate nohighlight">\(C\)</span> is the integration constant.  The NumPy function <code class="docutils literal notranslate"><span class="pre">polyint</span></code>, which takes the <span class="math notranslate nohighlight">\(n^\mathrm{th}\)</span> antiderivative of a polynomial, works as follows</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">15</span><span class="p">]:</span> <span class="n">P</span> <span class="o">=</span> <span class="n">polyint</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">16</span><span class="p">]:</span> <span class="n">P</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">16</span><span class="p">]:</span> <span class="n">poly1d</span><span class="p">([</span> <span class="mf">0.66666667</span><span class="p">,</span>  <span class="mf">2.5</span>     <span class="p">,</span>  <span class="mf">1.</span>      <span class="p">,</span>  <span class="mf">0.</span>      <span class="p">])</span>
</pre></div>
</div>
<p>When <code class="docutils literal notranslate"><span class="pre">polyint</span></code> has a single input, <code class="docutils literal notranslate"><span class="pre">p</span></code> is this case, <code class="docutils literal notranslate"><span class="pre">polyint</span></code> returns the coefficients of the antiderivative with the integration constant set to zero, as <code class="docutils literal notranslate"><span class="pre">Out[16]</span></code> illustrates.  It is then an easy matter to determine any definite integral of the polynomial <span class="math notranslate nohighlight">\(p(x) = 2x^2 + 5x +1\)</span> since</p>
<div class="math notranslate nohighlight">
\[q \equiv \int_a^b p(x)\, dx = P(b) - P(a) \;.\]</div>
<p>For example, if <span class="math notranslate nohighlight">\(a=1\)</span> and <span class="math notranslate nohighlight">\(b=5\)</span>,</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">17</span><span class="p">]:</span> <span class="n">q</span><span class="o">=</span><span class="n">P</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">-</span><span class="n">P</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">18</span><span class="p">]:</span> <span class="n">q</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">18</span><span class="p">]:</span> <span class="mf">146.66666666666666</span>
</pre></div>
</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[\int_1^5 \left(2x^2 + 5x +1\right)\, dx = 146\tfrac{2}{3} \;.\]</div>
</div>
</div>
<div class="section" id="double-integrals">
<span id="index-4"></span><h3><span class="section-number">9.2.2. </span>Double integrals<a class="headerlink" href="#double-integrals" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">scipy.integrate</span></code> function <code class="docutils literal notranslate"><span class="pre">dblquad</span></code> can be used to numerically evaluate double integrals of the form</p>
<div class="math notranslate nohighlight">
\[\int_{y=a}^{y=b} dy \int_{x=g(y)}^{x=h(y)} dx\,f(x,y)\]</div>
<p>The general form of <code class="docutils literal notranslate"><span class="pre">dblquad</span></code> is</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">scipy</span><span class="o">.</span><span class="n">integrate</span><span class="o">.</span><span class="n">dblquad</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">gfun</span><span class="p">,</span> <span class="n">hfun</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">func</span></code> if the name of the function to be integrated, <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> are the lower and upper limits of the <code class="docutils literal notranslate"><span class="pre">x</span></code> variable, respectively, and <code class="docutils literal notranslate"><span class="pre">gfun</span></code> and <code class="docutils literal notranslate"><span class="pre">hfun</span></code> are the <em>names</em> of the functions that define the lower and upper limits of the <code class="docutils literal notranslate"><span class="pre">y</span></code> variable.</p>
<p>As an example, let’s perform the double integral</p>
<div class="math notranslate nohighlight">
\[\int_0^{1/2} dy \int_0^{\sqrt{1-4y^2}} 16xy\, dx\]</div>
<p>We define the functions <cite>f</cite>, <cite>g</cite>, and <cite>h</cite>, using lambda expressions.  Note that even if <cite>g</cite>, and <cite>h</cite> are constants, as they may be in many cases, they must be defined as functions, as we have done here for the lower limit.</p>
<div class="highlight-ipython notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">19</span><span class="p">]:</span> <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="p">:</span> <span class="mi">16</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">20</span><span class="p">]:</span> <span class="n">g</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="mi">0</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">21</span><span class="p">]:</span> <span class="n">h</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">y</span> <span class="p">:</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">22</span><span class="p">]:</span> <span class="n">scipy</span><span class="o">.</span><span class="n">integrate</span><span class="o">.</span><span class="n">dblquad</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">22</span><span class="p">]:</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">5.551115123125783e-15</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>Once again, there are two outputs: the first is the value of the integral and the second is its absolute uncertainty.</p>
<p>Of course, the lower limit can also be a function of <span class="math notranslate nohighlight">\(y\)</span>, as we demonstrate here by performing the integral</p>
<div class="math notranslate nohighlight">
\[\int_0^{1/2} dy \int_{1-2y}^{\sqrt{1-4y^2}} 16xy\, dx\]</div>
<p>The code for this is given by</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">23</span><span class="p">]:</span> <span class="n">g</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">y</span> <span class="p">:</span> <span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">24</span><span class="p">]:</span> <span class="n">scipy</span><span class="o">.</span><span class="n">integrate</span><span class="o">.</span><span class="n">dblquad</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">24</span><span class="p">]:</span> <span class="p">(</span><span class="mf">0.33333333333333326</span><span class="p">,</span> <span class="mf">3.700743415417188e-15</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="other-integration-routines">
<h4><span class="section-number">9.2.2.1. </span>Other integration routines<a class="headerlink" href="#other-integration-routines" title="Permalink to this headline">¶</a></h4>
<p>In addition to the routines described above, <code class="docutils literal notranslate"><span class="pre">scipy.integrate</span></code> has a number of other integration routines, including <code class="docutils literal notranslate"><span class="pre">nquad</span></code>, which performs <span class="math notranslate nohighlight">\(n\)</span>-fold multiple integration, as well as other routines that implement other integration algorithms.  You will find, however, that <code class="docutils literal notranslate"><span class="pre">quad</span></code> and <code class="docutils literal notranslate"><span class="pre">dblquad</span></code> meet most of your needs for numerical integration.</p>
</div>
</div>
</div>
<div class="section" id="solving-odes">
<span id="index-5"></span><h2><span class="section-number">9.3. </span>Solving ODEs<a class="headerlink" href="#solving-odes" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">scipy.integrate</span></code> library has two powerful powerful routines, <code class="docutils literal notranslate"><span class="pre">ode</span></code> and <code class="docutils literal notranslate"><span class="pre">odeint</span></code>, for numerically solving systems of coupled first order ordinary differential equations (ODEs).  While <code class="docutils literal notranslate"><span class="pre">ode</span></code> is more versatile, <code class="docutils literal notranslate"><span class="pre">odeint</span></code> (ODE integrator) has a simpler Python interface works very well for most problems.  It can handle both stiff and non-stiff problems.  Here we provide an introduction to <code class="docutils literal notranslate"><span class="pre">odeint</span></code>.</p>
<p>A typical problem is to solve a second or higher order ODE for a given set of initial conditions.  Here we illustrate using <code class="docutils literal notranslate"><span class="pre">odeint</span></code> to solve the equation for a driven damped pendulum.  The equation of motion for the angle <span class="math notranslate nohighlight">\(\theta\)</span> that the pendulum makes with the vertical is given by</p>
<div class="math notranslate nohighlight">
\[\frac{d^2\theta}{dt^2} = -\frac{1}{Q} \frac{d\theta}{dt} +
                          \sin\theta + d \cos\Omega t\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is time, <span class="math notranslate nohighlight">\(Q\)</span> is the quality factor, <span class="math notranslate nohighlight">\(d\)</span> is the forcing amplitude, and <span class="math notranslate nohighlight">\(\Omega\)</span> is the driving frequency of the forcing.  Reduced variables have been used such that the natural (angular) frequency of oscillation is 1.  The ODE is nonlinear owing to the <span class="math notranslate nohighlight">\(\sin\theta\)</span> term.  Of course, it’s precisely because there are no general methods for solving nonlinear ODEs that one employs numerical techniques, so it seems appropriate that we illustrate the method with a nonlinear ODE.</p>
<p>The first step is always to transform any <span class="math notranslate nohighlight">\(n^\mathrm{th}\)</span>-order ODE into a system of <span class="math notranslate nohighlight">\(n\)</span> first order ODEs of the form:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\frac{dy_1}{dt} &amp;= f_1(t, y_1, ..., y_n) \\
\frac{dy_2}{dt} &amp;= f_2(t, y_1, ..., y_n) \\
    \vdots\quad &amp;= \quad\vdots \\
\frac{dy_n}{dt} &amp;= f_n(t, y_1, ..., y_n) \;.\end{split}\]</div>
<p>We also need <span class="math notranslate nohighlight">\(n\)</span> initial conditions, one for each variable <span class="math notranslate nohighlight">\(y_i\)</span>.  Here we have a second order ODE so we will have two coupled ODEs and two initial conditions.</p>
<p>We start by transforming our second order ODE into two coupled first order ODEs.  The transformation is easily accomplished by defining a new variable <span class="math notranslate nohighlight">\(\omega \equiv d\theta/dt\)</span>.  With this definition, we can rewrite our second order ODE as two coupled first order ODEs:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\frac{d\theta}{dt} &amp;= \omega \\
\frac{d\omega}{dt} &amp;= -\frac{1}{Q}\,\omega + \sin\theta
                      + d \cos\Omega t \;.\end{split}\]</div>
<p>In this case the functions on the right hand side of the equations are</p>
<div class="math notranslate nohighlight">
\[\begin{split}f_1(t, \theta, \omega) &amp;= \omega \\
f_2(t, \theta, \omega) &amp;= -\frac{1}{Q}\,\omega + \sin\theta
                          + d \cos\Omega t \;.\end{split}\]</div>
<p>Note that there are no explicit derivatives on the right hand side of the functions <span class="math notranslate nohighlight">\(f_i\)</span>; they are all functions of <span class="math notranslate nohighlight">\(t\)</span> and the various <span class="math notranslate nohighlight">\(y_i\)</span>, in this case <span class="math notranslate nohighlight">\(\theta\)</span> and <span class="math notranslate nohighlight">\(\omega\)</span>.</p>
<p>The initial conditions specify the values of <span class="math notranslate nohighlight">\(\theta\)</span> and <span class="math notranslate nohighlight">\(\omega\)</span> at <span class="math notranslate nohighlight">\(t=0\)</span>.</p>
<p>SciPy’s ODE solver <code class="docutils literal notranslate"><span class="pre">scipy.integrate.odeint</span></code> has three required arguments and many optional keyword arguments, of which we only need one, <code class="docutils literal notranslate"><span class="pre">args</span></code>, for this example.  So in this case, <code class="docutils literal notranslate"><span class="pre">odeint</span></code> has the form</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">odeint</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">())</span>
</pre></div>
</div>
<p>The first argument <code class="docutils literal notranslate"><span class="pre">func</span></code> is the name of a Python function that returns a list of values of the <span class="math notranslate nohighlight">\(n\)</span> functions <span class="math notranslate nohighlight">\(f_i(t, y_1, ..., y_n)\)</span> at a given time <span class="math notranslate nohighlight">\(t\)</span>.  The second argument <code class="docutils literal notranslate"><span class="pre">y0</span></code> is an array (or list) of the values of the initial conditions of <span class="math notranslate nohighlight">\(y_1, ..., y_n)\)</span>.  The third argument is the array of times at which you want <code class="docutils literal notranslate"><span class="pre">odeint</span></code> to return the values of <span class="math notranslate nohighlight">\(y_1, ..., y_n)\)</span>.  The keyword argument <code class="docutils literal notranslate"><span class="pre">args</span></code> is a tuple that is used to pass parameters (besides <code class="docutils literal notranslate"><span class="pre">y0</span></code> and <code class="docutils literal notranslate"><span class="pre">t</span></code>) that are needed to evaluate <code class="docutils literal notranslate"><span class="pre">func</span></code>.  Our example should make all of this clear.</p>
<p>After having written the <span class="math notranslate nohighlight">\(n^\mathrm{th}\)</span>-order ODE as a system of <span class="math notranslate nohighlight">\(n\)</span> first-order ODEs, the next task is to write the function <code class="docutils literal notranslate"><span class="pre">func</span></code>.  The function <code class="docutils literal notranslate"><span class="pre">func</span></code> should have three arguments: (1) the list (or array) of current <code class="docutils literal notranslate"><span class="pre">y</span></code> values, the current time <code class="docutils literal notranslate"><span class="pre">t</span></code>, and a list of any other parameters <code class="docutils literal notranslate"><span class="pre">params</span></code> needed to evaluate <code class="docutils literal notranslate"><span class="pre">func</span></code>.  The function <code class="docutils literal notranslate"><span class="pre">func</span></code> returns the values of the derivatives <span class="math notranslate nohighlight">\(dy_i/dt = f_i(t, y_1, ..., y_n)\)</span> in a list (or array).  Lines 5-11 illustrate how to write <code class="docutils literal notranslate"><span class="pre">func</span></code> for our example of a driven damped pendulum.  Here we name the function simply <code class="docutils literal notranslate"><span class="pre">f</span></code>, which is the name that appears in the call to <code class="docutils literal notranslate"><span class="pre">odeint</span></code> in line 33 below.</p>
<p>The only other tasks remaining are to define the parameters needed in the function, bundling them into a list (see line 22 below),  and to define the initial conditions, and bundling them into another list (see line 25 below).  After defining the time array in lines 28-30, the only remaining task is to call <code class="docutils literal notranslate"><span class="pre">odeint</span></code> with the appropriate arguments and a variable, <code class="docutils literal notranslate"><span class="pre">psoln</span></code> in this case to store output.  The output <code class="docutils literal notranslate"><span class="pre">psoln</span></code> is an <span class="math notranslate nohighlight">\(n\)</span> element array where each element is itself an array corresponding the the values of <span class="math notranslate nohighlight">\(y_i\)</span> for each time in the time <code class="docutils literal notranslate"><span class="pre">t</span></code> array that was an argument of <code class="docutils literal notranslate"><span class="pre">odeint</span></code>.  For this example, the first element <code class="docutils literal notranslate"><span class="pre">psoln[:,0]</span></code> is the <span class="math notranslate nohighlight">\(y_0\)</span> or <code class="docutils literal notranslate"><span class="pre">theta</span></code> array, and the second element <code class="docutils literal notranslate"><span class="pre">psoln[:,1]</span></code> is the <span class="math notranslate nohighlight">\(y_1\)</span> or <code class="docutils literal notranslate"><span class="pre">omega</span></code> array.  The remainder of the code simply plots out the results in different formats.  The resulting plots are shown in the figure <a class="reference internal" href="#fig-odepend"><span class="std std-ref">Pendulum trajectory</span></a> after the code.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">odeint</span>

<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
    <span class="n">theta</span><span class="p">,</span> <span class="n">omega</span> <span class="o">=</span> <span class="n">y</span>      <span class="c1"># unpack current values of y</span>
    <span class="n">Q</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">Omega</span> <span class="o">=</span> <span class="n">params</span>  <span class="c1"># unpack parameters</span>
    <span class="n">derivs</span> <span class="o">=</span> <span class="p">[</span><span class="n">omega</span><span class="p">,</span>      <span class="c1"># list of dy/dt=f functions</span>
             <span class="o">-</span><span class="n">omega</span><span class="o">/</span><span class="n">Q</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">Omega</span><span class="o">*</span><span class="n">t</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">derivs</span>

<span class="c1"># Parameters</span>
<span class="n">Q</span> <span class="o">=</span> <span class="mf">2.0</span>          <span class="c1"># quality factor (inverse damping)</span>
<span class="n">d</span> <span class="o">=</span> <span class="mf">1.5</span>          <span class="c1"># forcing amplitude</span>
<span class="n">Omega</span> <span class="o">=</span> <span class="mf">0.65</span>     <span class="c1"># drive frequency</span>

<span class="c1"># Initial values</span>
<span class="n">theta0</span> <span class="o">=</span> <span class="mf">0.0</span>     <span class="c1"># initial angular displacement</span>
<span class="n">omega0</span> <span class="o">=</span> <span class="mf">0.0</span>     <span class="c1"># initial angular velocity</span>

<span class="c1"># Bundle parameters for ODE solver</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">[</span><span class="n">Q</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">Omega</span><span class="p">]</span>

<span class="c1"># Bundle initial conditions for ODE solver</span>
<span class="n">y0</span> <span class="o">=</span> <span class="p">[</span><span class="n">theta0</span><span class="p">,</span> <span class="n">omega0</span><span class="p">]</span>

<span class="c1"># Make time array for solution</span>
<span class="n">tStop</span> <span class="o">=</span> <span class="mf">200.</span>
<span class="n">tInc</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="n">tStop</span><span class="p">,</span> <span class="n">tInc</span><span class="p">)</span>

<span class="c1"># Call the ODE solver</span>
<span class="n">psoln</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">params</span><span class="p">,))</span>

<span class="c1"># Plot results</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="c1"># Plot theta as a function of time</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">311</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">psoln</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;theta&#39;</span><span class="p">)</span>

<span class="c1"># Plot omega as a function of time</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">312</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">psoln</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;omega&#39;</span><span class="p">)</span>

<span class="c1"># Plot omega vs theta</span>
<span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">313</span><span class="p">)</span>
<span class="n">twopi</span> <span class="o">=</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">psoln</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">%</span><span class="n">twopi</span><span class="p">,</span> <span class="n">psoln</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;theta&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;omega&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="n">twopi</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<div class="figure align-center" id="id2">
<span id="fig-odepend"></span><a class="reference internal image-reference" href="../../_images/odePend.png"><img alt="../../_images/odePend.png" src="../../_images/odePend.png" style="width: 640.0px; height: 640.0px;" /></a>
<p class="caption"><span class="caption-text">Pendulum trajectory</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
<p>The plots above reveal that for the particular set of input parameters chosen, <code class="docutils literal notranslate"><span class="pre">Q</span> <span class="pre">=</span> <span class="pre">2.0</span></code>, <code class="docutils literal notranslate"><span class="pre">d</span> <span class="pre">=</span> <span class="pre">1.5</span></code>, and <code class="docutils literal notranslate"><span class="pre">Omega</span> <span class="pre">=</span> <span class="pre">0.65</span></code>, the pendulum trajectories are chaotic.  Weaker forcing (smaller <span class="math notranslate nohighlight">\(d\)</span>) leads to what is perhaps the more familiar behavior of sinusoidal oscillations with a fixed frequency which, at long times, is equal to the driving frequency.</p>
</div>
<div class="section" id="discrete-fast-fourier-transforms">
<span id="index-6"></span><h2><span class="section-number">9.4. </span>Discrete (fast) Fourier transforms<a class="headerlink" href="#discrete-fast-fourier-transforms" title="Permalink to this headline">¶</a></h2>
<p>The SciPy library has a number of routines for performing discrete Fourier transforms.  Before delving into them, we provide a brief review of Fourier transforms and discrete Fourier transforms.</p>
<div class="section" id="continuous-and-discrete-fourier-transforms">
<h3><span class="section-number">9.4.1. </span>Continuous and discrete Fourier transforms<a class="headerlink" href="#continuous-and-discrete-fourier-transforms" title="Permalink to this headline">¶</a></h3>
<p>The Fourier transform of a function <span class="math notranslate nohighlight">\(g(t)\)</span> is given by</p>
<div class="math notranslate nohighlight" id="equation-eq-ft">
<span class="eqno">(1)<a class="headerlink" href="#equation-eq-ft" title="Permalink to this equation">¶</a></span>\[ G(f) = \int_{-\infty}^\infty g(t)\, e^{-i\, 2\pi f t}\, dt \;,\]</div>
<p>where <span class="math notranslate nohighlight">\(f\)</span> is the Fourier transform variable; if <span class="math notranslate nohighlight">\(t\)</span> is time, then <span class="math notranslate nohighlight">\(f\)</span> is frequency.  The inverse transform is given by</p>
<div class="math notranslate nohighlight" id="equation-eq-ift">
<span class="eqno">(2)<a class="headerlink" href="#equation-eq-ift" title="Permalink to this equation">¶</a></span>\[ g(t) = \int_{-\infty}^\infty G(f)\, e^{i\, 2\pi ft}\, df\]</div>
<p>Here we define the Fourier transform in terms of the frequency <span class="math notranslate nohighlight">\(f\)</span> rather than the angular frequency <span class="math notranslate nohighlight">\(\omega = 2\pi f\)</span>.</p>
<p>The conventional Fourier transform is defined for continuous functions, or at least for functions that are dense and thus have an infinite number of data points.  When doing numerical analysis, however, you work with <em>discrete</em> data sets, that is, data sets defined for a finite number of points.  The discrete Fourier transform (DFT) is defined for a function <span class="math notranslate nohighlight">\(g_n\)</span> consisting of a set of <span class="math notranslate nohighlight">\(N\)</span> discrete data points.  Those <span class="math notranslate nohighlight">\(N\)</span> data points must be defined at <em>equally-spaced</em> times <span class="math notranslate nohighlight">\(t_n=n\Delta t\)</span> where <span class="math notranslate nohighlight">\(\Delta t\)</span> is the time between successive data points and <span class="math notranslate nohighlight">\(n\)</span> runs from 0 to <span class="math notranslate nohighlight">\(N-1\)</span>.  The discrete Fourier transform (DFT) of <span class="math notranslate nohighlight">\(g_n\)</span> is defined as</p>
<div class="math notranslate nohighlight" id="equation-eq-dft">
<span class="eqno">(3)<a class="headerlink" href="#equation-eq-dft" title="Permalink to this equation">¶</a></span>\[G_l = \sum_{n=0}^{N-1} g_n\, e^{-i\,(2\pi/N)\,ln}\]</div>
<p>where <span class="math notranslate nohighlight">\(l\)</span> runs from 0 to <span class="math notranslate nohighlight">\(N-1\)</span>.  The inverse discrete Fourier transform (iDFT) is defined as</p>
<div class="math notranslate nohighlight" id="equation-eq-idft">
<span class="eqno">(4)<a class="headerlink" href="#equation-eq-idft" title="Permalink to this equation">¶</a></span>\[g_n = \frac{1}{N} \sum_{l=0}^{N-1} G_l\, e^{i\,(2\pi/N)\,ln} \;.\]</div>
<p>The DFT is usually implemented on computers using the well-known Fast Fourier Transform (FFT) algorithm, generally credited to Cooley and Tukey who developed it at AT&amp;T Bell Laboratories during the 1960s.  But their algorithm is essentially one of many independent rediscoveries of the basic algorithm dating back to Gauss who described it as early as 1805.</p>
</div>
<div class="section" id="the-scipy-fft-library">
<h3><span class="section-number">9.4.2. </span>The SciPy FFT library<a class="headerlink" href="#the-scipy-fft-library" title="Permalink to this headline">¶</a></h3>
<p>The SciPy library <code class="docutils literal notranslate"><span class="pre">scipy.fftpack</span></code> has routines that implement a souped-up version of the FFT algorithm along with many ancillary routines that support working with DFTs.  The basic FFT routine in <code class="docutils literal notranslate"><span class="pre">scipy.fftpack</span></code> is appropriately named <code class="docutils literal notranslate"><span class="pre">fft</span></code>.  The program below illustrates its use, along with the plots that follow.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">fftpack</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">width</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">freq</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">101</span><span class="p">)</span>   <span class="c1"># linearly space time array</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">/</span><span class="n">width</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">freq</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>

<span class="n">dt</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>       <span class="c1"># increment between times in time array</span>

<span class="n">G</span> <span class="o">=</span> <span class="n">fftpack</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>   <span class="c1"># FFT of g</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">fftpack</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">dt</span><span class="p">)</span> <span class="c1"># frequenies f[i] of g[i]</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">fftpack</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>     <span class="c1"># shift frequencies from min to max</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">fftpack</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>     <span class="c1"># shift G order to coorespond to f</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;g(t)&#39;</span><span class="p">)</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">G</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;real part&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">G</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;coral&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;imaginary part&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;G(f)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<div class="figure align-center" id="id3">
<span id="fig-fftsimple"></span><a class="reference internal image-reference" href="../../_images/fftSimple.png"><img alt="Function :math:`g(t)` and its DFT :math:`G(f)`." src="../../_images/fftSimple.png" style="width: 560.0px; height: 420.8px;" /></a>
<p class="caption"><span class="caption-text">Function <span class="math notranslate nohighlight">\(g(t)\)</span> and its DFT <span class="math notranslate nohighlight">\(G(f)\)</span>.</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</div>
<p>The DFT has real and imaginary parts, both of which are plotted in the figure.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">fft</span></code> function returns the <span class="math notranslate nohighlight">\(N\)</span> Fourier components of <span class="math notranslate nohighlight">\(G_n\)</span> starting with the zero-frequency component <span class="math notranslate nohighlight">\(G_0\)</span> and progressing to the maximum positive frequency component <span class="math notranslate nohighlight">\(G_{(N/2)-1}\)</span> (or <span class="math notranslate nohighlight">\(G_{(N-1)/2}\)</span> if <span class="math notranslate nohighlight">\(N\)</span> is odd).  From there, <code class="docutils literal notranslate"><span class="pre">fft</span></code> returns the maximum <em>negative</em> component <span class="math notranslate nohighlight">\(G_{N/2}\)</span>  (or <span class="math notranslate nohighlight">\(G_{(N-1)/2}\)</span> if <span class="math notranslate nohighlight">\(N\)</span> is odd) and continues upward in frequency until it reaches the minimum negative frequency component <span class="math notranslate nohighlight">\(G_{N-1}\)</span>.  This is the standard way that DFTs are ordered by most numerical DFT packages.  The <code class="docutils literal notranslate"><span class="pre">scipy.fftpack</span></code> function <code class="docutils literal notranslate"><span class="pre">fftfreq</span></code> creates the array of frequencies in this non-intuitive order such that <code class="docutils literal notranslate"><span class="pre">f[n]</span></code> in the above routine is the correct frequency for the Fourier component <code class="docutils literal notranslate"><span class="pre">G[n]</span></code>.  The arguments of <code class="docutils literal notranslate"><span class="pre">fftfreq</span></code> are the size of the the orignal array <code class="docutils literal notranslate"><span class="pre">g</span></code> and the keyword argument <code class="docutils literal notranslate"><span class="pre">d</span></code> that is the spacing between the (equally spaced) elements of the time array (<code class="docutils literal notranslate"><span class="pre">d=1</span></code> if left unspecified).  The package <code class="docutils literal notranslate"><span class="pre">scipy.fftpack</span></code> provides the convenience function <code class="docutils literal notranslate"><span class="pre">fftshift</span></code> that reorders the frequency array so that the zero-frequency occurs at the middle of the array, that is, so the frequencies proceed monotonically from smallest (most negative) to largest (most positive).  Applying <code class="docutils literal notranslate"><span class="pre">fftshift</span></code> to both <code class="docutils literal notranslate"><span class="pre">f</span></code> and <code class="docutils literal notranslate"><span class="pre">G</span></code> puts the frequencies <code class="docutils literal notranslate"><span class="pre">f</span></code> in ascending order and shifts <code class="docutils literal notranslate"><span class="pre">G</span></code> so that the frequency of <code class="docutils literal notranslate"><span class="pre">G[n]</span></code> is given by the shifted <code class="docutils literal notranslate"><span class="pre">f[n]</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">scipy.fftpack</span></code> module also contains routines for performing 2-dimensional and <span class="math notranslate nohighlight">\(n\)</span>-dimensional DFTs, named <code class="docutils literal notranslate"><span class="pre">fft2</span></code> and <code class="docutils literal notranslate"><span class="pre">fftn</span></code>, respectively, using the FFT algorithm.</p>
<p>As for most FFT routines, the <code class="docutils literal notranslate"><span class="pre">scipy.fftpack</span></code> FFT routines are most efficient if <span class="math notranslate nohighlight">\(N\)</span> is a power of 2.  Nevertheless, the FFT routines are able to handle data sets where <span class="math notranslate nohighlight">\(N\)</span> is not a power of 2.</p>
<p><code class="docutils literal notranslate"><span class="pre">scipy.fftpack</span></code> also supplies an inverse DFT function <code class="docutils literal notranslate"><span class="pre">ifft</span></code>.  It is written to act on the <em>unshifted</em> FFT so take care!  Note also that <code class="docutils literal notranslate"><span class="pre">ifft</span></code> returns a <em>complex</em> array.  Because of machine roundoff error, the imaginary part of the function returned by <code class="docutils literal notranslate"><span class="pre">ifft</span></code> will, in general, be very near zero but not exactly zero even when the original function is a purely real function.</p>
</div>
</div>
<div class="section" id="linear-algebra">
<span id="index-7"></span><h2><span class="section-number">9.5. </span>Linear algebra<a class="headerlink" href="#linear-algebra" title="Permalink to this headline">¶</a></h2>
<p>Python’s mathematical libraries, NumPy and SciPy, have extensive tools for numerically solving problems in linear algebra.  Here we focus on two problems that arise commonly in scientific and engineering settings: (1) solving a system of linear equations and (2) eigenvalue problems.  In addition, we also show how to perform a number of other basic computations, such as finding the determinant of a matrix, matrix inversion, and <span class="math notranslate nohighlight">\(LU\)</span> decomposition.  The SciPy package for linear algebra is called <code class="docutils literal notranslate"><span class="pre">scipy.linalg</span></code>.</p>
<div class="section" id="basic-computations-in-linear-algebra">
<h3><span class="section-number">9.5.1. </span>Basic computations in linear algebra<a class="headerlink" href="#basic-computations-in-linear-algebra" title="Permalink to this headline">¶</a></h3>
<p>SciPy has a number of routines for performing basic operations with matrices.  The determinant of a matrix is computed using the <code class="docutils literal notranslate"><span class="pre">scipy.linalg.det</span></code> function:</p>
<div class="highlight-ipython notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="kn">import</span> <span class="nn">scipy.linalg</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">a</span> <span class="o">=</span> <span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]])</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">a</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">],</span>
               <span class="p">[</span> <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">]])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="o">-</span><span class="mf">22.0</span>
</pre></div>
</td></tr></table></div>
<p>The inverse of a matrix is computed using the <code class="docutils literal notranslate"><span class="pre">scipy.linalg.inv</span></code> function, while the product of two matrices  is calculated using the NumPy <code class="docutils literal notranslate"><span class="pre">dot</span></code> function:</p>
<div class="highlight-ipython notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="n">b</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="n">b</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">0.22727273</span><span class="p">,</span>  <span class="mf">0.13636364</span><span class="p">],</span>
               <span class="p">[</span> <span class="mf">0.18181818</span><span class="p">,</span>  <span class="mf">0.09090909</span><span class="p">]])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">7</span><span class="p">]:</span> <span class="n">dot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">7</span><span class="p">]:</span> <span class="n">array</span><span class="p">([[</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">],</span>
               <span class="p">[</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">]])</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="solving-systems-of-linear-equations">
<span id="index-8"></span><h3><span class="section-number">9.5.2. </span>Solving systems of linear equations<a class="headerlink" href="#solving-systems-of-linear-equations" title="Permalink to this headline">¶</a></h3>
<p>Solving systems of equations is nearly as simple as constructing a coefficient matrix and a column vector.  Suppose you have the following system of linear equations to solve:</p>
<div class="math notranslate nohighlight">
\[\begin{split}2x_1 + 4x_2 + 6x_3 &amp;= 4\\
 x_1 - 3x_2 - 9x_3 &amp;= -11\\
8x_1 + 5x_2 - 7x_3 &amp;= 1\\\end{split}\]</div>
<p>The first task is to recast this set of equations as a matrix equation of the form <span class="math notranslate nohighlight">\(\mathsf{A}\, \mathbf{x} = \mathbf{b}\)</span>.  In this  case, we have:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathsf{A} = \left(\begin{array}{ccc}2 &amp;  4 &amp;  6 \\
                                     1 &amp; -3 &amp; -9 \\
                                     8 &amp;  5 &amp; -7 \end{array}\right)
                                     \;,\quad
\mathbf{x} = \left(\begin{array}{c}x_1 \\x_2 \\x_3\end{array}\right)
                                     \;,\quad
\mathbf{b} = \left(\begin{array}{c}4 \\-11 \\1\end{array}\right) \;.\end{split}\]</div>
<p>Next we construct the array <span class="math notranslate nohighlight">\(\mathsf{A}\)</span> and vector <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> as NumPy arrays:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">8</span><span class="p">]:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">]])</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">9</span><span class="p">]:</span> <span class="n">b</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">11</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<p>Finally we use the SciPy function <code class="docutils literal notranslate"><span class="pre">scipy.linalg.solve</span></code> to find <span class="math notranslate nohighlight">\(x_1\)</span>, <span class="math notranslate nohighlight">\(x_2\)</span>, and <span class="math notranslate nohighlight">\(x_3\)</span>.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">10</span><span class="p">]:</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">10</span><span class="p">]:</span> <span class="n">array</span><span class="p">([</span> <span class="o">-</span><span class="mf">8.91304348</span><span class="p">,</span>  <span class="mf">10.2173913</span> <span class="p">,</span>  <span class="o">-</span><span class="mf">3.17391304</span><span class="p">])</span>
</pre></div>
</div>
<p>which gives the results: <span class="math notranslate nohighlight">\(x_1=-8.91304348\)</span>, <span class="math notranslate nohighlight">\(x_2= 10.2173913\)</span>, and <span class="math notranslate nohighlight">\(x_3= -3.17391304\)</span>.  Of course, you can get the same answer by noting that <span class="math notranslate nohighlight">\(\mathbf{x}=\mathsf{A}^{-1}\mathbf{b}\)</span>.  Following this approach, we can use the <cite>scipy.linalg.inv</cite> introduced in the previous section:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">Ainv</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">10</span><span class="p">]:</span> <span class="n">dot</span><span class="p">(</span><span class="n">Ainv</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">10</span><span class="p">]:</span> <span class="n">array</span><span class="p">([</span> <span class="o">-</span><span class="mf">8.91304348</span><span class="p">,</span>  <span class="mf">10.2173913</span> <span class="p">,</span>  <span class="o">-</span><span class="mf">3.17391304</span><span class="p">])</span>
</pre></div>
</div>
<p>which is the same answer we obtained using <code class="docutils literal notranslate"><span class="pre">scipy.linalg.solve</span></code>.  Using <code class="docutils literal notranslate"><span class="pre">scipy.linalg.solve</span></code> is numerically more stable and a faster than using <span class="math notranslate nohighlight">\(\mathbf{x}=\mathsf{A}^{-1}\mathbf{b}\)</span>, so it is the preferred method for solving systems of equations.</p>
<p>You might wonder what happens if the system of equations are not all linearly independent.  For example if the matrix <span class="math notranslate nohighlight">\(\mathsf{A}\)</span> is given by</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathsf{A} = \left(\begin{array}{ccc}2 &amp;  4 &amp;  6 \\
                                     1 &amp; -3 &amp; -9 \\
                                     1 &amp;  2 &amp;  3 \end{array}\right)\end{split}\]</div>
<p>where the third row is a multiple of the first row.  Let’s try it out and see what happens.  First we change the bottom row of the matrix <span class="math notranslate nohighlight">\(\mathsf{A}\)</span> and then try to solve the system as we did before.</p>
<div class="highlight-ipython notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">11</span><span class="p">]:</span> <span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">12</span><span class="p">]:</span> <span class="n">A</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">12</span><span class="p">]:</span> <span class="n">array</span><span class="p">([[</span> <span class="mi">2</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">6</span><span class="p">],</span>
                <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">],</span>
                <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">]])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
<span class="n">LinAlgError</span><span class="p">:</span> <span class="n">Singular</span> <span class="n">matrix</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">14</span><span class="p">]:</span> <span class="n">Ainv</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">LinAlgError</span><span class="p">:</span> <span class="n">Singular</span> <span class="n">matrix</span>
</pre></div>
</td></tr></table></div>
<p>Whether we use <code class="docutils literal notranslate"><span class="pre">scipy.linalg.solve</span></code> or <code class="docutils literal notranslate"><span class="pre">scipy.linalg.inv</span></code>, SciPy raises an error because the matrix is singular.</p>
</div>
<div class="section" id="eigenvalue-problems">
<span id="index-9"></span><h3><span class="section-number">9.5.3. </span>Eigenvalue problems<a class="headerlink" href="#eigenvalue-problems" title="Permalink to this headline">¶</a></h3>
<p>One of the most common problems in science and engineering is the eigenvalue problem, which in matrix form is written as</p>
<div class="math notranslate nohighlight">
\[\mathsf{A}\mathbf{x} = \lambda \mathbf{x}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathsf{A}\)</span> is a square matrix, <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> is a column vector, and <span class="math notranslate nohighlight">\(\lambda\)</span> is a scalar (number).   Given the matrix <span class="math notranslate nohighlight">\(\mathsf{A}\)</span>, the problem is to find the set of eigenvectors <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> and their corresponding eigenvalues <span class="math notranslate nohighlight">\(\lambda\)</span> that solve this equation.</p>
<p>We can solve eigenvalue equations like this using <code class="docutils literal notranslate"><span class="pre">scipy.linalg.eig</span></code>. the outputs of this function is an array whose entries are the eigenvalues and a matrix whose rows are the eigenvectors.  Let’s return to the matrix we were using previously and find its eigenvalues and eigenvectors.</p>
<div class="highlight-ipython notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">],[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">]])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">15</span><span class="p">]:</span> <span class="n">A</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">15</span><span class="p">]:</span> <span class="n">array</span><span class="p">([[</span> <span class="mi">2</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">6</span><span class="p">],</span>
                <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">],</span>
                <span class="p">[</span> <span class="mi">8</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">]])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">16</span><span class="p">]:</span> <span class="n">lam</span><span class="p">,</span> <span class="n">evec</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">17</span><span class="p">]:</span> <span class="n">lam</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">17</span><span class="p">]:</span> <span class="n">array</span><span class="p">([</span> <span class="mf">2.40995356</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.03416016</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>
                <span class="o">-</span><span class="mf">2.37579340</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">18</span><span class="p">]:</span> <span class="n">evec</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">18</span><span class="p">]:</span> <span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">0.77167559</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.52633654</span><span class="p">,</span>  <span class="mf">0.57513303</span><span class="p">],</span>
                <span class="p">[</span> <span class="mf">0.50360249</span><span class="p">,</span>  <span class="mf">0.76565448</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.80920669</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">0.38846018</span><span class="p">,</span>  <span class="mf">0.36978786</span><span class="p">,</span>  <span class="mf">0.12002724</span><span class="p">]])</span>
</pre></div>
</td></tr></table></div>
<p>The first eigenvalue and its corresponding eigenvector are given by</p>
<div class="highlight-ipython notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">19</span><span class="p">]:</span> <span class="n">lam</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">19</span><span class="p">]:</span> <span class="p">(</span><span class="mf">2.4099535647625494</span><span class="o">+</span><span class="mi">0</span><span class="n">j</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">20</span><span class="p">]:</span> <span class="n">evec</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">20</span><span class="p">]:</span> <span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.77167559</span><span class="p">,</span>  <span class="mf">0.50360249</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.38846018</span><span class="p">])</span>
</pre></div>
</td></tr></table></div>
<p>We can check that they satisfy the <span class="math notranslate nohighlight">\(\mathsf{A}\mathbf{x} = \lambda \mathbf{x}:\)</span></p>
<div class="highlight-ipython notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">21</span><span class="p">]:</span> <span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">evec</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">21</span><span class="p">]:</span> <span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.85970234</span><span class="p">,</span>  <span class="mf">1.21365861</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.93617101</span><span class="p">])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">22</span><span class="p">]:</span> <span class="n">lam</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">evec</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">22</span><span class="p">]:</span> <span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.85970234</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">1.21365861</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>
                <span class="o">-</span><span class="mf">0.93617101</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">])</span>
</pre></div>
</td></tr></table></div>
<p>Thus we see by direct substitution that the left and right sides of <span class="math notranslate nohighlight">\(\mathsf{A}\mathbf{x} = \lambda \mathbf{x}:\)</span> are equal.   In general, the eigenvalues can be complex, so their values are reported as complex numbers.</p>
<div class="section" id="generalized-eigenvalue-problem">
<span id="index-10"></span><h4><span class="section-number">9.5.3.1. </span>Generalized eigenvalue problem<a class="headerlink" href="#generalized-eigenvalue-problem" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">scipy.linalg.eig</span></code> function can also solve the <em>generalized</em> eigenvalue problem</p>
<div class="math notranslate nohighlight">
\[\mathsf{A}\mathbf{x} = \lambda \mathsf{B}\mathbf{x}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathsf{B}\)</span> is a square matrix with the same size as <span class="math notranslate nohighlight">\(\mathsf{A}\)</span>.  Suppose, for example, that we have</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">22</span><span class="p">]:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">]])</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">22</span><span class="p">]:</span> <span class="n">B</span> <span class="o">=</span> <span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">]])</span>
</pre></div>
</div>
<p>Then we can solve the generalized eigenvalue problem by entering <span class="math notranslate nohighlight">\(\mathsf{B}\)</span> as the optional second argument to <code class="docutils literal notranslate"><span class="pre">scipy.linalg.eig</span></code></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">23</span><span class="p">]:</span> <span class="n">lam</span><span class="p">,</span> <span class="n">evec</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
<p>The solutions are returned in the same fashion as before, as an array <code class="docutils literal notranslate"><span class="pre">lam</span></code> whose entries are the eigenvalues and a matrix <code class="docutils literal notranslate"><span class="pre">evac</span></code> whose rows are the eigenvectors.</p>
<div class="highlight-ipython notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">24</span><span class="p">]:</span> <span class="n">lam</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">24</span><span class="p">]:</span> <span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.36087907</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.83252442</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>
                <span class="o">-</span><span class="mf">0.10099858</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">25</span><span class="p">]:</span> <span class="n">evec</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">25</span><span class="p">]:</span> <span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">0.0419907</span> <span class="p">,</span> <span class="o">-</span><span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">0.93037493</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">0.43028153</span><span class="p">,</span>  <span class="mf">0.17751302</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span>        <span class="p">],</span>
                <span class="p">[</span> <span class="mf">1.</span>        <span class="p">,</span> <span class="o">-</span><span class="mf">0.29852465</span><span class="p">,</span>  <span class="mf">0.4226201</span> <span class="p">]])</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="hermitian-and-banded-matrices">
<span id="index-11"></span><h4><span class="section-number">9.5.3.2. </span>Hermitian and banded matrices<a class="headerlink" href="#hermitian-and-banded-matrices" title="Permalink to this headline">¶</a></h4>
<p>SciPy has a specialized routine for solving eigenvalue problems for Hermitian (or real symmetric) matrices.  The routine for hermitian matrices is <code class="docutils literal notranslate"><span class="pre">scipy.linalg.eigh</span></code>.  It is more efficient (faster and uses less memory) than <code class="docutils literal notranslate"><span class="pre">scipy.linalg.eig</span></code>.  The basic syntax of the two routines is the same, although some of the <em>optional</em> arguments are different.  Both routines can solve generalized as well as standard eigenvalue problems.</p>
<p>SciPy also has a specialized routine <code class="docutils literal notranslate"><span class="pre">scipy.linalg.eig_banded</span></code> for solving eigenvalue problems for real symmetric or complex hermitian banded matrices.</p>
</div>
</div>
</div>
<div class="section" id="solving-non-linear-equations">
<span id="sec-findingroots"></span><span id="index-12"></span><h2><span class="section-number">9.6. </span>Solving non-linear equations<a class="headerlink" href="#solving-non-linear-equations" title="Permalink to this headline">¶</a></h2>
<p>SciPy has many different routines for numerically solving non-linear equations or systems of non-linear equations.  Here we will introduce only a few of these routines, the ones that are relatively simple and appropriate for the most common types of nonlinear equations.</p>
<div class="section" id="single-equations-of-a-single-variable">
<h3><span class="section-number">9.6.1. </span>Single equations of a single variable<a class="headerlink" href="#single-equations-of-a-single-variable" title="Permalink to this headline">¶</a></h3>
<p>Solving a single nonlinear equation is enormously simpler than solving a system of nonlinear equations, so that is where we start.  A word of caution: solving non-linear equations can be a tricky business so it is important that you have a good sense of the behavior of the function you are trying to solve.  The best way to do this is to plot the function over the domain of interest before trying to find the solutions.  This will greatly assist you in finding the solutions you seek and avoiding spurious solutions.</p>
<p>We begin with a concrete example.  Suppose we want to find the solutions to the equation</p>
<div class="math notranslate nohighlight">
\[\tan x=\sqrt{(8/x)^2-1}\]</div>
<p>Plots of <span class="math notranslate nohighlight">\(\tan x\)</span> and <span class="math notranslate nohighlight">\(\sqrt{(8/x)^2-1}\)</span> <em>vs</em> <span class="math notranslate nohighlight">\(x\)</span> are shown in the top plot in the figure <span class="xref std std-ref">fig-subplotDemo</span>, albeit with <span class="math notranslate nohighlight">\(x\)</span> replaced by <span class="math notranslate nohighlight">\(\theta\)</span>.  The solutions to this equation are those <span class="math notranslate nohighlight">\(x\)</span> values where the two curves <span class="math notranslate nohighlight">\(\tan x\)</span> and <span class="math notranslate nohighlight">\(\sqrt{(8/x)^2-1}\)</span> cross each other. The first step towards obtaining a numerical solution is to rewrite the equation to be solved in the form <span class="math notranslate nohighlight">\(f(x)=0\)</span>.  Doing so, the above equation becomes</p>
<div class="math notranslate nohighlight">
\[\tan x - \sqrt{(8/x)^2-1} = 0\]</div>
<p>Obviously the two equations above have the same solutions for <span class="math notranslate nohighlight">\(x\)</span>.  Parenthetically we mention that the problem of finding the solutions to equations of the form <span class="math notranslate nohighlight">\(f(x)=0\)</span> is often referred to as <em>finding the roots</em> of <span class="math notranslate nohighlight">\(f(x)\)</span>.</p>
<p>Next, we plot <span class="math notranslate nohighlight">\(f(x)\)</span> over the domain of interest, in this case from <span class="math notranslate nohighlight">\(x=0\)</span> to 8.  We are only interested in positive solutions and for <span class="math notranslate nohighlight">\(x&gt;8\)</span>, the equation has no real solutions as the argument of the square root becomes negative.  The solutions, the points where <span class="math notranslate nohighlight">\(f(x)=0\)</span> are indicated by green circles; there are three of them. Another notable feature of the function is that it diverges to <span class="math notranslate nohighlight">\(\pm\infty\)</span> at <span class="math notranslate nohighlight">\(x = \{0, \pi/2, 3\pi/2, 5\pi/2\}\)</span>.</p>
<div class="figure align-center" id="id4">
<span id="fig-rootdemo"></span><a class="reference internal image-reference" href="../../_images/rootsBrent.png"><img alt="Roots of a nonlinear function" src="../../_images/rootsBrent.png" style="width: 540.0px; height: 360.0px;" /></a>
<p class="caption"><span class="caption-text">Roots of a nonlinear function</span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</div>
<div class="section" id="brent-method">
<span id="index-13"></span><h4><span class="section-number">9.6.1.1. </span>Brent method<a class="headerlink" href="#brent-method" title="Permalink to this headline">¶</a></h4>
<p>One of the workhorses for finding solutions to a single variable nonlinear equation is the method of Brent, discussed in many texts on numerical methods.  SciPy’s implementation of the Brent algorithm is the function <code class="docutils literal notranslate"><span class="pre">scipy.optimize.brentq(f,</span> <span class="pre">a,</span> <span class="pre">b)</span></code>, which has three required arguments.  The first <code class="docutils literal notranslate"><span class="pre">f</span></code> is the name of the user-defined function to be solved.  The next two, <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> are the <span class="math notranslate nohighlight">\(x\)</span> values that bracket the solution you are looking for.  You should choose <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> so that there is only one solutions in the interval between <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code>.  Brent’s method also requires that <code class="docutils literal notranslate"><span class="pre">f(a)</span></code> and <code class="docutils literal notranslate"><span class="pre">f(b)</span></code> have opposite signs; an error message is returned if they do not.  Thus to find the three solutions to <span class="math notranslate nohighlight">\(\tan x - \sqrt{(8/x)^2-1} = 0\)</span>, we need to run <code class="docutils literal notranslate"><span class="pre">scipy.optimize.brentq(f,</span> <span class="pre">a,</span> <span class="pre">b)</span></code> three times using three different values of <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> that bracket each of the three solutions.  The program below illustrates the how to use <code class="docutils literal notranslate"><span class="pre">scipy.optimize.brentq</span></code></p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy.optimize</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="k">def</span> <span class="nf">tdl</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">y</span> <span class="o">=</span> <span class="mf">8.</span><span class="o">/</span><span class="n">x</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="n">y</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span>

<span class="c1"># Find true roots</span>

<span class="n">rx1</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">brentq</span><span class="p">(</span><span class="n">tdl</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.49</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="n">rx2</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">brentq</span><span class="p">(</span><span class="n">tdl</span><span class="p">,</span> <span class="mf">0.51</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mf">1.49</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="n">rx3</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">brentq</span><span class="p">(</span><span class="n">tdl</span><span class="p">,</span> <span class="mf">1.51</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mf">2.49</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="n">rx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">rx1</span><span class="p">,</span> <span class="n">rx2</span><span class="p">,</span> <span class="n">rx3</span><span class="p">])</span>
<span class="n">ry</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="c1"># print using a list comprehension</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">True roots:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;f(</span><span class="si">{0:0.5f}</span><span class="s1">) = </span><span class="si">{1:0.2e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">tdl</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">rx</span><span class="p">))</span>

<span class="c1"># Find false roots</span>

<span class="n">rx1f</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">brentq</span><span class="p">(</span><span class="n">tdl</span><span class="p">,</span> <span class="mf">0.49</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mf">0.51</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="n">rx2f</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">brentq</span><span class="p">(</span><span class="n">tdl</span><span class="p">,</span> <span class="mf">1.49</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mf">1.51</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="n">rx3f</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">brentq</span><span class="p">(</span><span class="n">tdl</span><span class="p">,</span> <span class="mf">2.49</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mf">2.51</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="n">rxf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">rx1f</span><span class="p">,</span> <span class="n">rx2f</span><span class="p">,</span> <span class="n">rx3f</span><span class="p">])</span>
<span class="c1"># print using a list comprehension</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">False roots:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;f(</span><span class="si">{0:0.5f}</span><span class="s1">) = </span><span class="si">{1:0.2e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">tdl</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">rxf</span><span class="p">))</span>

<span class="c1"># Plot function and various roots</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">tdl</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># Create masked array for plotting</span>
<span class="n">ymask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">&gt;</span><span class="mf">20.</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ymask</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">3.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">5.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\tan x - \sqrt{(8/x)^2-1}$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rx</span><span class="p">,</span> <span class="n">ry</span><span class="p">,</span> <span class="s1">&#39;og&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;true roots&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rxf</span><span class="p">,</span> <span class="n">ry</span><span class="p">,</span> <span class="s1">&#39;xr&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;false roots&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">numpoints</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">,</span> <span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;upper right&#39;</span><span class="p">,</span>
           <span class="n">bbox_to_anchor</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.92</span><span class="p">,</span> <span class="mf">0.97</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>Running this code generates the following output:</p>
<div class="highlight-ipython notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">run</span> <span class="n">rootbrentq</span><span class="o">.</span><span class="n">py</span>

<span class="kc">True</span> <span class="n">roots</span><span class="p">:</span>
<span class="n">f</span><span class="p">(</span><span class="mf">1.39547</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mf">6.39e-14</span>
<span class="n">f</span><span class="p">(</span><span class="mf">4.16483</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mf">7.95e-14</span>
<span class="n">f</span><span class="p">(</span><span class="mf">6.83067</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.11e-15</span>

<span class="kc">False</span> <span class="n">roots</span><span class="p">:</span>
<span class="n">f</span><span class="p">(</span><span class="mf">1.57080</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.61e+12</span>
<span class="n">f</span><span class="p">(</span><span class="mf">4.71239</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.56e+12</span>
<span class="n">f</span><span class="p">(</span><span class="mf">7.85398</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.16e+12</span>
</pre></div>
</td></tr></table></div>
<p>The Brent method finds the three true roots of the equation quickly and accurately when you provide values for the brackets <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> that are valid.  However, like many numerical methods for finding roots, the Brent method can produce spurious roots as it does in the above example when <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> bracket singularities like those at <span class="math notranslate nohighlight">\(x = \{\pi/2, 3\pi/2, 5\pi/2\}\)</span>.  Here we evaluated the function at the purported roots found by <code class="docutils literal notranslate"><span class="pre">brentq</span></code> to verify that the values of <span class="math notranslate nohighlight">\(x\)</span> found were indeed roots.  For the true roots, the values of the function were very near zero, to within an acceptable roundoff error of less than <span class="math notranslate nohighlight">\(10^{-13}\)</span>.  For the false roots, exceedingly large numbers on the order of  <span class="math notranslate nohighlight">\(10^{12}\)</span> were obtained, indicating a possible problem with these roots.  These results, together with the plots, allow you to unambiguously identify the true solutions to this nonlinear function.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">brentq</span></code> function has a number of optional keyword arguments that you may find useful.  One keyword argument causes <code class="docutils literal notranslate"><span class="pre">brentq</span></code> to return not only the solution but the value of the function evaluated at the solution.  Other arguments allow you to specify a tolerance to which the solution is found as well as a few other parameters possibly of interest.  Most of the time, you can leave the keyword arguments at their default values.  See the <code class="docutils literal notranslate"><span class="pre">brentq</span></code> entry online on the SciPy web site for more information.</p>
</div>
<div class="section" id="other-methods-for-solving-equations-of-a-single-variable">
<span id="index-14"></span><h4><span class="section-number">9.6.1.2. </span>Other methods for solving equations of a single variable<a class="headerlink" href="#other-methods-for-solving-equations-of-a-single-variable" title="Permalink to this headline">¶</a></h4>
<p>SciPy provides a number of other methods for solving nonlinear equations of a single variable.  It has an implementation of the Newton-Raphson method called <code class="docutils literal notranslate"><span class="pre">scipy.optimize.newton</span></code>.  It’s the racecar of such methods; its super fast but less stable that the Brent method.  To fully realize its speed, you need to specify not only the function to be solved, but also its first derivative, which is often more trouble than its worth.  You can also specify its second derivative, which may further speed up finding the solution.  If you do not specify the first or second derivatives, the method uses the secant method, which is usually slower than the Brent method.</p>
<p id="index-15">Other methods, including the Ridder (<code class="docutils literal notranslate"><span class="pre">scipy.optimize.ridder</span></code>) and bisection (<code class="docutils literal notranslate"><span class="pre">scipy.optimize.bisect</span></code>), are also available, although the Brent method is generally superior.  SciPy let’s you use your favorite.</p>
</div>
</div>
<div class="section" id="solving-systems-of-nonlinear-equations">
<span id="index-16"></span><h3><span class="section-number">9.6.2. </span>Solving systems of nonlinear equations<a class="headerlink" href="#solving-systems-of-nonlinear-equations" title="Permalink to this headline">¶</a></h3>
<p>Solving systems of nonlinear equations is not for the faint of heart.  It is a difficult problem that lacks any general purpose solutions.  Nevertheless, SciPy provides quite an assortment of numerical solvers for nonlinear systems of equations.  However, because of the complexity and subtleties of this class of problems, we do not discuss their use here.</p>
</div>
</div>
<div class="section" id="exercises">
<h2><span class="section-number">9.7. </span>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p>Use NumPy’s <code class="docutils literal notranslate"><span class="pre">polyval</span></code> function together with SciPy to plot the following functions:</p>
<ol class="loweralpha simple">
<li><p>The first four Chebyshev polynomials of first kind.  Plot these over the interval from -1 to +1.</p></li>
<li><p>The first four Hermite polynomials  <em>multiplied</em> by <span class="math notranslate nohighlight">\(e^{-x^2/2}\)</span>.  Plot these on the interval from -5 to +5.  These are the first four wave functions of the quantum mechanical simple harmonic oscillator.</p></li>
</ol>
</li>
</ol>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="../chap8/chap8_fitting.html" class="btn btn-neutral float-left" title="8. Curve Fitting" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright David J Pine

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>